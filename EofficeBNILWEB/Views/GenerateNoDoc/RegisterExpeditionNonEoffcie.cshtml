@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer localiza
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor Accessor
@{
    var sessidUser = Accessor.HttpContext.Session.GetString("idUser");
    var sessidUnit = Accessor.HttpContext.Session.GetString("idUnit");
    var en = Accessor.HttpContext.Session.GetString("en");
    var ina = Accessor.HttpContext.Session.GetString("ina");
    int no = 1;
}
<style>
    .hide {
  display: none;
}
</style>
<!-- begin::Body -->
<div class="m-grid__item m-grid__item--fluid m-grid m-grid--hor-desktop m-grid--desktop m-body">
    <div class="m-grid__item m-grid__item--fluid  m-grid m-grid--ver    m-container m-container--responsive m-container--xxl m-page__container">
        <div class="m-grid__item m-grid__item--fluid m-wrapper">
            <!-- BEGIN: Subheader -->
            <div class="m-subheader ">
                <div class="d-flex align-items-center">
                    <div class="mr-auto" style="color: white;">
                        <h3 class="m-subheader__title m-subheader__title--separator" style="color: white;">
                           @(en != null ? "EXPEDITION" : "EKSPEDISI")
                        </h3>
                        <ul class="m-subheader__breadcrumbs m-nav m-nav--inline">
                            <li class="m-nav__item m-nav__item--home">
                                <a href="#" class="m-nav__link m-nav__link--icon">
                                    <i class="m-nav__link-icon la la-home" style="color: white;"></i>
                                </a>
                            </li>
                            <li class="m-nav__separator" style="color: white;">
                                -
                            </li>
                            <li class="m-nav__item">
                                <a href="" class="m-nav__link">
                                    <span class="m-nav__link-text" style="color: white;">
                                        MAILING ROOM
                                    </span>
                                </a>
                            </li>
                            <li class="m-nav__separator" style="color: white;">
                                -
                            </li>
                            <li class="m-nav__item">
                                <a href="" class="m-nav__link">
                                    <span class="m-nav__link-text" style="color: white;">
                                        @(en != null ? "NON E-OFFICE DOCUMENTS" : "DOKUMEN NON E-OFFICE")
                                    </span>
                                </a>
                            </li>
                            <li class="m-nav__separator" style="color: white;">
                                -
                            </li>
                            <li class="m-nav__item">
                                <a href="" class="m-nav__link">
                                    <span class="m-nav__link-text" style="color: white;">
                                        @(en != null ? "EXPEDITION" : "EKSPEDISI")
                                    </span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- END: Subheader -->
            <div class="m-content" style="padding: 30px 30px !important;">
                <!--Begin::Main Portlet-->
                <div class="m-portlet m-portlet--full-height ">
                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link @ViewBag.UlTabActiveHome" id="home-tab" data-toggle="tab" href="#home">
                                <span class="nav-icon">
                                    <i class="flaticon2-file-1"></i>
                                </span>
                                <span class="nav-text">Manual</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @ViewBag.UlTabActiveUpload" id="profile-tab" data-toggle="tab" href="#profile" aria-controls="profile">
                                <span class="nav-icon">
                                    <i class="flaticon-upload"></i>
                                </span>
                                <span class="nav-text">  @(en != null ? "Data Input With Excel Documents" : "Input Data Dengan Dokumen Excel")</span>
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content" id="myTabContent">

                        @*Insert Manual*@
                        <div class="tab-pane fade @ViewBag.DivTabActiveHome" id="home" role="tabpanel" aria-labelledby="home-tab">
                            <div class="m-portlet__body">
                               @* <form asp-action="ExportExcel" target="_blank">*@
                                    <div>
                                        
                                    </div>
                               @* </form>*@
                                <br />
                                <br />
                                <br />
                                <div class="table-responsive">
                                    <table id="myTablee" class="table table-bordered table-striped">
                                        <thead>
                                            <tr>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "No" : "No")</th>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "No AWB / No Delivery" : "No AWB / No Pengiriman")</th>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Reference number" : "Nomor Refrensi")</th>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Delivery date" : "Tanggal Pengiriman")</th>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Expedition Name" : "Nama Ekspedisi")</th>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Sender Name" : "Nama Pengirim")</th>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Division" :"Divisi")</th>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Division Code" :"Kode Divsi")</th>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Letter Number" : "Nomor Surat")</th>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Purpose Name" : "Nama Tujuan")</th>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Phone Number" : "Nomor Telepon")</th>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Addres" : "Alamat")</th>
                                                @*<th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Receiver Name" : "Nama Penerima")</th>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Receiver Date" : "Tanggal Penerima")</th>*@
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Delivery Status" : "Status Pengiriman")</th>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Create By" : "Dibuat oleh")</th>
                                                <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Updated By" : "Diubah oleh")</th>
                                                
                                                @*<th>@(en != null ? "Action" : "Aksi")</th>*@
                                            </tr>
                                        </thead>
                                        <tbody>
                                             @foreach (var item in ViewBag.AllNonLetter)
                                                {
                                                    <tr>
                                                        <td>@no</td>
                                                        <td>@item.nmrawb</td>
                                                        <td>@item.nmrreferen</td>
                                                        <td>@item.ReceiptDate.ToString("dd-MM-yyyy")</td>
                                                        <td>@item.expedition_name</td>
                                                        <td>@item.sender_name - @item.nip</td>
                                                        <td>@item.unitname</td>
                                                        <td>@item.kodeunit</td>
                                                        <td>@item.letter_number</td>
                                                        <td>@item.docReceiver</td>
                                                        <td>@item.phonenumber</td>
                                                        <td>@item.address</td>
                                                        @*<td>@item.purposename</td>
                                                        @if (item.statuskirim == 3)
                                                        {
                                                        <td>@item.DateUntil.ToString("dd-MM-yyyy")</td>
                                                        }else{
                                                            <td></td>
                                                        }*@
                                                        
                                                        <td>@(@item.statuskirim == 1 ? "Proses" :  item.statuskirim == 2 ? "Dikembalikan" : item.statuskirim == 3 ? "Selesai Antar" : "")</td>
                                                        <td>@item.cretaeby</td>
                                                        <td>@item.updateby</td>
                                                    
                                                        @*<td>
                                                                <a class="btn btn-danger passingID" data-id="@item.letter_number" data-toggle="modal" data-target="#my-modal" href="#" style="line-height: 5px; color:white; background-color:#225999 !important;width:155px;">Update</a>
                                                          
                                                        </td>*@
                                                    </tr>
                                                    no++;
                                              }
                                        </tbody>
                                    </table>
                                    <div class="modal fade" id="my-modal" tabindex="-1" role="dialog" aria-labelledby="my-modal" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel">@(en != null ? "Expedition Delivery Status Update" : "Update Status Pengiriman Ekspedisi")</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <form method="post" asp-action="UpdateLetterNonEoffice" asp-controller="GenerateNoDoc" >
                                                    <div class="modal-body" id="employee_detail"></div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    

                                </div>
                                <br />
                                <br />
                               <hr />
                                <div class="m-portlet__head-caption">
                                    <h5>
                                        @(en != null ? "Update data using excel documents" : "Update data menggunakan dokumen excel")
                                    </h5>
                                </div>
                    
                                @*update document*@
                                <div class="row">
                                    <div class="col-sm-6">
                                        <form method="post" asp-action="UpdateUploadDocumentNonEoffice" asp-controller="GenerateNoDoc" enctype="multipart/form-data">
                                            <div class="form-group">
                                                <div class="btn-group col-sm-2">
                                                    @*<a asp-action="DownloadTemplateUpdateNonEoffice" asp-controller="GenerateNoDoc" class="btn btn-primary btn-bold">
                                                        <i class="flaticon2-download"></i> Download Template Update
                                                    </a>*@
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label class="col-sm-2 col-form-label">Upload File:</label>
                                                <div class="col-sm-6">
                                                    <div class="kt-uppy" id="kt_uppy_5">
                                                        <div class="kt-uppy__wrapper">
                                                            <div class="uppy-Root uppy-FileInput-container">
                                                                <input type="hidden" name="DOC_NAME1" value="" placeholder="File Name...">
                                                                <input class="uppy-FileInput-input btn btn-label-brand btn-bold btn-font-sm" style="" type="file" name="inputfile" id="kt_uppy_5_input_control" accept="xlsx">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <span class="form-text text-muted">File type: XLSX </span>
                                                </div>
                                            </div>
                                            <div class="tab-content">
                                                <button class="btn btn-success" type="submit">Upload</button>
                                                <a href="#" data-toggle="modal" data-target="#my-modal3" id="btncari"  class="btn btn-primary btn-bold">
                                                        Export
                                                </a>
                                                
                                                <br>
                                            </div>
                                        </form>
                                    </div>

                                    <div class="col-sm-6">
                                        <div class="table-responsive">
                                            @if (ViewBag.OutputUpdate != null)
                                            {
                                                <table id="myTablee" class="table table-striped table-bordered dt-responsive nowrap dataTable no-footer" height="50%" width="100%" cellspacing="0">
                                                    <thead>
                                                        <tr>
                                                            <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "No AWB / No Delivery" : "No AWB / No Pengiriman")</th>
                                                            <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Reference number" : "Nomor Refrensi")</th>
                                                            @*<th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "NPP" : "NPP")</th>*@
                                                            <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Expedition Name" : "Nama Ekspedisi")</th>
                                                            <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Sender Name" : "Nama Pengirim")</th>
                                                            <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Division" :"Divisi")</th>
                                                            <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Division Code" :"Kode Divsi")</th>
                                                            <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Letter Number" : "Nomor Surat")</th>
                                                            <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Purpose Name" : "Nama Tujuan")</th>
                                                            <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Phone Number" : "Nomor Telepon")</th>
                                                            <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Addres" : "Alamat")</th>
                                                            <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Receiver Name" : "Nama Penerima")</th>
                                                            <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Delivery Status" : "Status Pengiriman")</th>
                                                            <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Upload Status" : "Status Upload")</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        @foreach (var item in ViewBag.OutputUpdate)
                                                        {
                                                                <tr style="@(item.statusUpload.Contains("Gagal") ? "background-color: #ec592d" : "");height:50px">
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.nmrawb</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.nmrreferen</td>
                                                                @*<td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.nip</td>*@
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.expedition_name</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.sender_name - @item.nip</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.unitname</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.kodeunit</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.letter_number</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.docReceiver</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.phonenumber</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.address</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.purposename</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.statuskirim</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.statusUpload</td>

                                                               
                                                            </tr>
                                                        }
                                                    </tbody>
                                                </table>
                                            }
                                        </div>
                                    </div>
                                </div>
                                
                              
                                
                                <div class="modal fade" id="my-modal3" tabindex="-1" role="dialog" aria-labelledby="my-modal3" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel">Report</ h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                <form method="post" name="form2" id="form2" asp-action="GetDataExportExcelEkspedisiNonEoffice" asp-controller="GenerateNoDoc" target="_parent">
                                                            <div class="form-group">
                                                                <input type="text" hidden value="1" class="form-control" name="delivery_type" id="delivery_type">
                                                                <input type="text" hidden value="1" class="form-control" name="trackingNumber" id="trackingNumber">
                                                                <label for="inputEmail3" class="col-sm-3 col-form-label">&nbsp;@(en != null ? "Start Date" : "Tanggal Awal")</label>
                                                                <input type="text" class="form-control" id="m_datepicker_1" autocomplete="off" name="startDate" onchange="myChangeFunction2(this)">
                                                                <label for="inputEmail3" class="col-sm-3 col-form-label">&nbsp;@(en != null ? "End Date" : "Tanggal Akhir")</label>
                                                                <input type="text" class="form-control" id="m_datepicker_1" autocomplete="off" name="endDate" onchange="myChangeFunction3(this)">
                                                            </div>

                                                            @* <div class="form-group">
                                                            <input type="text" hidden value="1" class="form-control" name="delivery_type" id="delivery_type">
                                                            <label for="password1">@(en != null ? "Delivery Type" : "Tipe Jenis Antaran")</label>
                                                            <select class="form-control select2-selection__rendered" id="type_report"  name="type_report" required>
                                                            <option value="">--@(en != null ? "Delivery Type" : "Pilih Tipe Jenis Antaran")--</option>

                                                            @foreach (var item in ViewBag.DeliveryType)
                                                            {
                                                            <option value="@item.attributeValue">@item.value</option>
                                                            }
                                                            </select>
                                                            </div>*@
                                                            <div class="modal-footer border-top-0 d-flex justify-content-center">
                                                                <div class="btn-group">
                                                                    <button type="submit" class="btn btn-primary" onClick="window.location.reload()">Submit</button>
                                                                </div>
                                                            </div>
                                                    </form>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                <hr />
                                <br />
                                <br />
                                <form method="post">
                                        @*<div class="form-group row">
                                            <label for="inputEmail3" class="col-sm-2 col-form-label">&nbsp; Jenis Dokumen</label>
                                            <div class="col-sm-4">
                                                <select class="form-control select2-selection__rendered" id="documentType" name="documentType" required>
                                                    <option value="">--Pilih Tipe Dokumen--</option>
                                                    @foreach (var item in ViewBag.DocumentType)
                                                    {
                                                        <option value="@item.attributeValue">@item.value</option>
                                                    }
                                                </select>
                                            </div>
                                        </div>*@
                                        <div class="form-group row">
                                            <label for="inputtext3" class="col-sm-2 col-form-label">&nbsp; @(en != null ? "letter number" : "Nomor Surat")</label>
                                            <div class="col-sm-4">
                                                @*<select class="form-control select2-selection__rendered" id="letter_number" name="letter_number">
                                                <option value="">-- @(en != null ? "Select letter number" : " Pilih Nomor Surat")Pilih No Surat--</option>
                                                    <option value="12345">12345</option>
                                                    <option value="45678">45678</option>
                                                </select>*@
                                                <input type="text" id="letter_number"  name="letter_number" class="form-control ui-autocomplete-input" autocomplete="off" role="textbox" aria-autocomplete="list" aria-haspopup="true" autocomplete="off">
                                               
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                        <label for="inputtext3" class="col-sm-2 col-form-label">&nbsp; @(en != null ? "Receipt Date" : "Tanggal Diterima")</label>
                                            <div class="col-sm-4">
                                                <input type="text" class="form-control" id="ReceiptDate" name="ReceiptDate" value="@Convert.ToDateTime(DateTime.Now).ToString("dd-MM-yyyy")" readonly="readonly" style="background-color: #e6e9ec;">
                                                 <input type="text" class="form-control" hidden id="delivery_type" name="delivery_type" required class="form-control ui-autocomplete-input" value="1" autocomplete="off" role="textbox" aria-autocomplete="list" aria-haspopup="true">
                                            </div>
                                        </div>
                                       @* <div class="form-group row">
                                        <label for="inputtext3" class="col-sm-2 col-form-label">&nbsp; @(en != null ? "Delivery Type" : "Tipe Jenis Antaran")</label>
                                            <div class="col-sm-4">
                                                <select class="form-control select2-selection__rendered" id="type_report" name="type_report">
                                                <option value="">-- @(en != null ? " Select Delivery Type" : "Pilih Tipe Jenis Antaran")--</option>
                                                    @foreach (var item in ViewBag.DeliveryType)
                                                    {
                                                        <option value="@item.attributeValue">@item.value</option>
                                                    }
                                                    
                                                </select>
                                            </div>
                                        </div>*@
                                        <div class="form-group row">
                                        <label for="inputpassword3" class="col-sm-2 col-form-label">&nbsp; @(en != null ? "Expedition Name" : "Nama Ekspedisi")</label>
                                            <div class="col-sm-4">
                                            <input type="text" class="form-control" id="expedition_Name" name="expedition_name" required class="form-control ui-autocomplete-input" autocomplete="off" role="textbox" aria-autocomplete="list" aria-haspopup="true" autocomplete="off">
                                            </div>
                                        </div>
                                        
                                        @*<div class="form-group row">
                                            <label for="inputpassword3" class="col-sm-2 col-form-label">&nbsp; Nomor Referal</label>
                                            <div class="col-sm-4">
                                                <input type="text" class="form-control" id="nmrreferal" name="nmrreferal" required>
                                            </div>
                                        </div>*@
                                        
                                        <div class="form-group row">
                                        <label for="inputpassword3" class="col-sm-2 col-form-label">&nbsp; @(en != null ? "Sender Name" : "Nama Pengirim")</label>
                                            <div class="col-sm-4">
                                            <input type="text" class="form-control" id="sender_name" name="sender_name" required autocomplete="off">
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                        <label for="inputEmail3" class="col-sm-2 col-form-label">&nbsp; @(en != null ? "Division" : "Divisi")</label>
                                            <div class="col-sm-4">
                                                <select class="form-control select2-selection__rendered" id="idUnitSelect" name="idUnitSelect" required disabled onchange="changeReceiver(this.value)">
                                                <option value="">--@(en != null ? "Division" : "Divisi")--</option>
                                                    @foreach (var item in ViewBag.Divison)
                                                    {
                                                        <option value="@item.idUnit">@item.unitName</option>

                                                    }
                                                </select>
                                            <input type="hidden" class="form-control" id="idUnit" name="idUnit">
                                            </div>
                                        </div>
                                        
                                        <div class="form-group row">
                                            
                                        <label for="inputpassword3" class="col-sm-2 col-form-label">&nbsp; @(en != null ? "Purpose Name" : "Nama Tujuan")</label>
                                            <div class="col-sm-4">
                                            <input type="text" class="form-control" id="docReceiver" name="docReceiver" required autocomplete="off">
                                            </div>
                                        </div>

                                        <div class="form-group row">
                                            <label for="inputpassword3" class="col-sm-2 col-form-label">&nbsp; @(en != null ? "Phone Number" : "Nomor Telepon")</label>
                                            <div class="col-sm-4">
                                            <input type="text" class="form-control" id="phonenumber" name="phonenumber" required autocomplete="off">
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="inputpassword3" class="col-sm-2 col-form-label">&nbsp; @(en != null ? "Reference Number" : "Nomor Referensi")</label>
                                            <div class="col-sm-4">
                                                <input type="text" class="form-control" id="nmrreferen" name="nmrreferen" autocomplete="off">
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="inputpassword3" class="col-sm-2 col-form-label">&nbsp; @(en != null ? "No AWB / No Delivery" : "No AWB / No Pengiriman")</label>
                                            <div class="col-sm-4">
                                            <input type="text" class="form-control" id="nmrawb" name="nmrawb" autocomplete="off">
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                        <label for="inputpassword3" class="col-sm-2 col-form-label">&nbsp; @(en != null ? "Address" : "Alamat")</label>
                                            <div class="col-sm-4">
                                                <textarea id="w3review" name="address" rows="4" cols="50"></textarea>
                                            </div>
                                        </div>
                                        @*<div class="form-group row">
                                            <label for="inputpassword3" class="col-sm-2 col-form-label">&nbsp; @(en != null ? "Receiver Name" : "Nama Penerima")</label>
                                            <div class="col-sm-4">
                                            <input type="text" class="form-control" id="purposename" name="purposename">
                                            </div>
                                        </div>
                                        
                                      <input type="text" hidden class="form-control" id="proses" name="proses"  value ="1">*@
                                        
                                    <div class="tab-content">
                                        <button class="btn btn-success" type="submit">Submit</button>
                                        <br>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        @*insert document*@
                        <div class="tab-pane @ViewBag.DivTabActiveUpload" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                            <div class="m-portlet__body">
                                <div class="row">
                                    @*insert document*@
                                    <div class="col-sm-12">
                                        <form method="post" asp-action="UploadDocumentNonEoffice" asp-controller="GenerateNoDoc" enctype="multipart/form-data">
                                            <div class="form-group">
                                                <div class="btn-group col-sm-2">
                                                    <a asp-action="DownloadTemplateNonEoffice" asp-controller="GenerateNoDoc" class="btn btn-primary btn-bold">
                                                        <i class="flaticon2-download"></i> Download Template Insert
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label class="col-sm-2 col-form-label">Upload File:</label>
                                                <div class="col-sm-6">
                                                    <div class="kt-uppy" id="kt_uppy_5">
                                                        <div class="kt-uppy__wrapper">
                                                            <div class="uppy-Root uppy-FileInput-container">
                                                                <input type="hidden" name="DOC_NAME1" value="" placeholder="File Name...">
                                                                <input class="uppy-FileInput-input btn btn-label-brand btn-bold btn-font-sm" style="" type="file" name="inputfile" id="kt_uppy_5_input_control" accept="xlsx">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <span class="form-text text-muted">File type: XLSX </span>
                                                </div>
                                            </div>
                                            <div class="tab-content">
                                                <button class="btn btn-success" type="submit">Upload</button>
                                                <br>
                                            </div>
                                        </form>
                                        <div class="table-responsive" style="padding-top: 3%;">
                                            @if (ViewBag.Output != null)
                                            {
                                                <table id="myTable" class="table table-striped table-bordered dt-responsive nowrap" width="100%" cellspacing="0">
                                                    <thead>
                                                        <tr>
                                                            <th>@(en != null ? "No AWB / No Delivery" : "No AWB / No Pengiriman")</th>
                                                            <th>@(en != null ? "Reference number" : "Nomor Refrensi")</th>
                                                            <th>@(en != null ? "NPP" : "NPP")</th>
                                                            <th>@(en != null ? "Delivery date" : "Tanggal Pengiriman")</th>
                                                            <th>@(en != null ? "Expedition Name" : "Nama Ekspedisi")</th>
                                                            <th>@(en != null ? "Sender Name" : "Nama Pengirim")</th>
                                                            <th>@(en != null ? "Division Code" :"Kode Divsi")</th>
                                                            <th>@(en != null ? "Letter Number" : "Nomor Surat")</th>
                                                            <th>@(en != null ? "Purpose Name" : "Nama Tujuan")</th>
                                                            <th>@(en != null ? "Phone Number" : "Nomor Telepon")</th>
                                                            <th>@(en != null ? "Addres" : "Alamat")</th>
                                                           @* <th>@(en != null ? "Receiver Name" : "Nama Penerima")</th>
                                                            <th>@(en != null ? "Receiver Date" : "Tanggal Penerima")</th>*@
                                                            <th>@(en != null ? "Delivery Status" : "Status Pengiriman")</th>
                                                            <th>@(en != null ? "Upload Status" : "Status Upload")</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        @foreach (var item in ViewBag.Output)
                                                        {
                                                            <tr style="@(item.statusUpload.Contains("Gagal") ? "background-color: #ec592d" : "")">
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.nmrawb</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.nmrreferen</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.nip</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.ReceiptDate</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.expedition_name</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.sender_name - @item.nip</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.unitname</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.letter_number</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.docReceiver</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.phonenumber</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.address</td>
                                                                @*<td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.purposename</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.DateUntil</td>*@
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.statuskirim</td>
                                                                <td style="@(item.statusUpload.Contains("Gagal") ? "color: white" : "")">@item.statusUpload</td>

                                                        
                                                            </tr>
                                                        }
                                                    </tbody>
                                                </table>
                                            }
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--End::Main Portlet-->
            </div>
        </div>
    </div>
</div>
<!-- END: Body -->
<script type="text/javascript">

    $(document).ready(function () {
        $('#myTablee').DataTable({
             scrollY: true,
             scrollX: true,
            //"ordering": false
             //order: [[ 0, "desc" ]]
        });
        //   $(document).on("click", ".passingID", function () {
        //    var ids = $(this).attr('data-id');
        //    $.ajax({
        //        url: "@Url.Action("GetDetailEkspedisiNon","GenerateNoDoc")",
        //        method: "POST",
        //        data: { ids: ids },
        //        success: function (data) {
        //            $('#employee_detail').html(data);
        //            $(".modal-body #letter_number").val(ids);
        //        }
        //    });
       
        //});

    });  

    $('#my-modal3').on('hidden.bs.modal', function () {
        $('#my-modal3 form')[0].reset();
    });
    
    //$(document).on("click", ".passingID", function () {
    //    var ids = $(this).attr('data-id');
    //    $.ajax({
    //        url: "@Url.Action("GetDetailEkspedisiNon","GenerateNoDoc")",
    //        method: "POST",
    //        data: { ids: ids },
    //        success: function (data) {
    //            $('#employee_detail').html(data);
    //            $(".modal-body #letter_number").val(ids);
    //        }
    //    });
       
    //});

    //$(document).on("click", ".passingID", function () {
    //    var ids = $(this).attr('data-id');
    //    $(".modal-body #letter_number").val(ids);
    //});

    //  $(document).on("click", ".passingqrcode", function () {
    //    var ids = $(this).attr('data-id');
    //    $(".modal-body #qrcode").val(ids);
    //});

    window.addEventListener("load", () => { // when the page loads
        document.getElementById("delivery_type").addEventListener("change", function () {
            document.getElementById("profile-tab").classList.toggle("hide", this.value === "2")
        })
    })



    function changeReceiver(val) {
        var value = val.split(" _ ");
        if (val != "") {
            document.getElementById("idUnit").value = value[0];
            document.getElementById("receiverName").value = value[2];
        }
        else {
            document.getElementById("receiverName").value = "";
            document.getElementById("idUserTu").value = "";
        }

    }
    
    $("#sender_name").autocomplete({
        minLength: 3,
        source: function (req, res) {
            $.ajax({
                url: "@Url.Action("GetUserCopy","GenerateNoDoc")",
                method: "POST",
                data: { keyword: req.term },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    var d = $.map(data, function (row) {
                        return {
                            label: row.userName + " - " + row.nip,
                            value: row.idUnit + " _ " + row.idUser + " _ " + row.userName
                        }
                    });
                    res(d);
                }
            });
        },
        focus: function (event, ui) {
            $("#sender_name").val(ui.item.label);

            return false;
        },
        select: function (event, ui) {
            $("#sender_name").val(ui.item.label);
            var select = document.querySelector('#idUnitSelect');
            var splitValue = ui.item.value.split(" _ ");
            console.log(splitValue[0])
            $('#idUnitSelect option').filter(function () {
                return $.trim($(this).val()).includes(splitValue[0]);
            }).prop('selected', true);
            select.dispatchEvent(new Event('change'));

            return false;
        }
    });

    $("#expedition_Name").autocomplete({
        minLength: 3,
        source: function (req, res) {
            $.ajax({
                url: "@Url.Action("GetEkspediCopy","GenerateNoDoc")",
                method: "POST",
                data: { keyword: req.term },
                success: function (msg) {
                    var data = JSON.parse(msg);
                
                    var d = $.map(data, function (row) {
                        return {
                            label: row.expedition_name,
                            value: row.expedition_name
                        }
                    });
                    res(d);
                }
            });
        },
        focus: function (event, ui) {
            $("#expedition_Name").val(ui.item.label);

            return false;
        }
        

    });
    function myChangeFunction2(input2) {
        var input2 = document.getElementById('m_datepicker_1');
        datestart.value = input2.value;
    }
    function myChangeFunction3(input3) {
        var input22 = document.getElementById('m_datepicker_1');
        dateend.value = input3.value;
    }
    
</script>