@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer localiza
@using Microsoft.AspNetCore.Http
@using System.Web;
@using Newtonsoft.Json
@inject IHttpContextAccessor Accessor
@{
    var sessidUser = Accessor.HttpContext.Session.GetString("idUser");
    var sessidUnit = Accessor.HttpContext.Session.GetString("idUnit");
    var sessidGroup = Accessor.HttpContext.Session.GetString("idGroup");
    var en = Accessor.HttpContext.Session.GetString("en");
    var ina = Accessor.HttpContext.Session.GetString("ina");
    var orderkepada = 0;
    var orderpemeriksa = 0;

    var orderpenerima = 0;
    var ordercarboncopy = 0;
    var orderdelibretion = 0;
    var orderApprover = 0;
    var orderpemeriksalain = 0;

    var numButton = 0;
    var noTemplate = 1;
    //var idDivKepada = "divbarukepada" + orderkepada;
    var idDivTembusan = "divbarutembusan" + orderpemeriksa;
    string dateNow = DateTime.Now.ToString("yyyy-MM-dd");
    var jsonTemplateData = JsonConvert.SerializeObject(ViewBag.TemplateData);
}
<style>
    .tox-promotion {
        display: none !important;
    }
</style>
<!-- begin::Body -->
<div class="m-grid__item m-grid__item--fluid m-grid m-grid--hor-desktop m-grid--desktop m-body">
    <div class="m-grid__item m-grid__item--fluid  m-grid m-grid--ver    m-container m-container--responsive m-container--xxl m-page__container">
        <div class="m-grid__item m-grid__item--fluid m-wrapper">
            <!-- BEGIN: Subheader -->
            <div class="m-subheader ">
                <div class="d-flex align-items-center">
                    <div class="mr-auto" style="color: white;">
                        <h3 class="m-subheader__title m-subheader__title--separator" style="color: white;">
                             @(en != null ? "Create Memo Others" : "Buat Memo Lainnya")
                        </h3>
                        <ul class="m-subheader__breadcrumbs m-nav m-nav--inline">
                            <li class="m-nav__item m-nav__item--home">
                                <a href="#" class="m-nav__link m-nav__link--icon">
                                    <i class="m-nav__link-icon la la-home" style="color: white;"></i>
                                </a>
                            </li>
                            <li class="m-nav__separator" style="color: white;">
                                -
                            </li>
                            <li class="m-nav__item">
                                <a href="" class="m-nav__link">
                                    <span class="m-nav__link-text" style="color: white;">
                                        Office
                                    </span>
                                </a>
                            </li>
                            <li class="m-nav__separator" style="color: white;">
                                -
                            </li>
                            <li class="m-nav__item">
                                <a href="" class="m-nav__link">
                                    <span class="m-nav__link-text" style="color: white;">
                                      Memo
                                    </span>
                                </a>
                            </li>
                             <li class="m-nav__separator" style="color: white;">
                                -
                            </li>
                            <li class="m-nav__item">
                                <a href="" class="m-nav__link">
                                    <span class="m-nav__link-text" style="color: white;">
                                       @(en != null ? "Create Memo Others" : "Buat Memo Lainnya")
                                    </span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- END: Subheader -->
            <div class="m-content">
                <div class="kt-container  kt-grid__item kt-grid__item--fluid">
                    <div class="kt-grid kt-grid--desktop kt-grid--ver-desktop  kt-inbox" id="kt_inbox">
                        <div class="kt-grid__item kt-grid__item--fluid    kt-portlet    kt-inbox__view kt-inbox__view--shown-" id="kt_inbox_view" style="display:block">
                            <form method="post" id="formSurat" asp-action="SaveLetterMemo" asp-controller="BackDate" enctype="multipart/form-data">
                                <div class="row">
                                    <div class="col-md-6 col-sm-12" style="padding-top: 1%;padding-left: 2%;">
                                        <fieldset>
                                            <legend style="font-size: 10pt"><b>@(en != null ? "Header" : "Kepala Surat")</b></legend>
                                            <div class="form-group row">
                                                <div class="col-lg-6">
                                                    <label>@(en != null ? "Document" : "Dokumen")<span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                               
                                                     <select class="form-control select2-search select2-search--dropdown" id="outboxType" name="outboxType" required onchange="getTipeMemo(this.value)">
                                                        <option value="">--@(en != null ? "Select Document Memo" : "Pilih Dokumen Memo")--</option>
                                                        
                                                         @foreach (var item in ViewBag.JenisMemo)
                                                          {
                                                                <option value="@item.attributeValue">@item.value</option>
                                                          }

                                                            @*<option value="4">Memo Direksi</option>
                                                            @if (sessidGroup == "S" || sessidUnit == "D52B6D38-EA42-ED11-958D-0050568AADBF" || sessidUnit == "DA2B6D38-EA42-ED11-958D-0050568AADBF")
                                                            {
                                                                <option value="5">Memo Dewan Komisaris</option>
                                                            }
                                                            <option value="6">Memo Divisi</option>*@
                                                                @* @foreach (var item in ViewBag.JenisMemo)
                                                              {
                                                                        <option value="@item.attributeValue">
                                                                            @{
                                                                                var value = item.value.Split('_');
                                                                            }
                                                                            @value[0]
                                                                        </option>
                                                               }*@
                                                    </select>
                                                    <input type="hidden" class="form-control" id="saveType" name="saveType">
                                                    <input type="hidden" class="form-control" id="letterTypeCode" name="letterTypeCode" value="4">
                                                    <input type="hidden" class="form-control" id="idresponsesurat" name="idresponsesurat" value="@Guid.Empty">
                                                </div>

                                                 <div class="col-lg-6">
                                                    <label>@(en != null ? "Memo Type" : "Tipe Memo")<span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                    <select class="form-control select2-selection__rendered" id="idMemoType" name="idMemoType" required>
                                                        <option value="">--@(en != null ? "Select Memo Type" : "Pilih Tipe Memo")--</option>
                                                    </select>
                                                </div>
                                                
                                                <div class="col-lg-6">
                                                    <label>@(en != null ? "Number of Memo:" : "Nomor Memo:")</label>
                                                    <input type="text" class="form-control"  readonly="1" style="background-color:#e6e9ec !important">
                                                </div>
                                                <div class="col-lg-6">
                                                    <label>@(en != null ? "Date:" : "Tanggal:")</label>
                                                    <input type="date" class="form-control" placeholder="Tanggal" value="@dateNow" max="@dateNow" id="letterDate" max name="letterDate">
                                                </div>
                                            </div>
                                           
                                            <div class="form-group row">
                                                <div class="col-md-12">
                                                    <label>@(en != null ? "Subject" : "Perihal") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                    <input autocomplete="off" type="text" class="form-control" id="about" name="about" required>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <div class="col-lg-4">
                                                    <label>@(en != null ? "Result" : "Hasil") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                    <select class="form-control" id="resultType" name="resultType" required>
                                                        <option value="">--@(en != null ? "Select Mail Results" : "Pilih Hasil Surat")--</option>
                                                        <option value="1">Softcopy</option>
                                                        <option value="2">Hardcopy</option>
                                                    </select>
                                                </div>
                                                <div class="col-lg-4">
                                                    <label>@(en != null ? "Signature" : "Tanda tangan") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                    <select class="form-control" id="signatureType" name="signatureType" required>
                                                        <option value="">--@(en != null ? "Select Signature Type" : "Pilih Jenis Tanda Tangan")--</option>
                                                        <option value="1">Tanda Tangan</option>
                                                        <option value="2">QR Code</option>
                                                        <option value="3">Tidak ada</option>
                                                        @*<option value="3">Tanda Tangan & QR Code</option>*@
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <div class="col-lg-4">
                                                    <label>@(en != null ? "Attachment" : "Lampiran")</label>
                                                    <input type="text" autocomplete="off" class="form-control" id="attachmentCount" name="attachmentCount" readonly="readonly" style="background-color:#e6e9ec !important">
                                                </div>
                                            </div>

                                            <fieldset>
                                                <legend style="font-size: 10pt"><b>@(en != null ? "Sender" : "Pengirim")</b></legend>
                                                <div class="form-group row" style="margin-bottom: 0px !important;">
                                                    <div class="col-md-12">
                                                        <label>@(en != null ? "Name" : "Nama") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                        <input type="text" class="form-control" autocomplete="off" id="bossName" name="bossName" placeholder="" required="" onkeyup="load_data(this.value,1000)">
                                                        <span id="search_result_sender"></span>
                                                        <input type="hidden" class="form-control" id="bossPositionId" name="bossPositionId">
                                                        <input type="hidden" class="form-control" id="bossUserId" name="bossUserId">
                                                        <input type="hidden" class="form-control" id="bossUnitId" name="bossUnitId">
                                                        <input type="hidden" class="form-control" id="bossLevelId" name="bossLevelId">
                                                    </div>
                                                </div>
                                                <div class="form-group row" style="margin-bottom: 0px !important;">
                                                    <div class="col-md-3">
                                                        <label>NPP <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                        <input type="text" class="form-control" autocomplete="off" id="nipBoss" name="nipBoss" required readonly="readonly" style="background-color:#e6e9ec !important">
                                                    </div>
                                                    <div class="col-md-9">
                                                        <label>@(en != null ? "Position" : "Jabatan") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                        <input type="text" class="form-control" id="bossPositionName" name="bossPositionName" required readonly="readonly" style="background-color:#e6e9ec !important">
                                                    </div>
                                                </div>
                                            </fieldset>
                                        </fieldset>
                                    </div>
                                    <div class="col-md-6 col-sm-12" style="padding-top: 1%;padding-left: 2%;">
                                        <fieldset>
                                            <legend style="font-size: 10pt"><b>@(en != null ? "Recipient" : "Penerima")</b></legend>
                                            @*<div class="form-group row" style="margin-bottom: 0px !important;">
                                                <div class="col-8 col-md-6 col-sm-10">
                                                    <label>Nama <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                    <input type="text" class="form-control" id="senderName" name="senderName" required>
                                                </div>
                                                <div class="col-4 col-md-6 col-sm-2">
                                                    <label>&nbsp;</label>
                                                    <input type="button" value="+" id="btnAddReceiver" onclick="AddTextBoxReceiver()" class="btn btn-success" style="display:block">
                                                </div>
                                            </div>
                                            <div id="TextBoxContainerReceiver">
                                                <!--Textboxes will be added here -->
                                            </div>
                                            <div class="form-group row" style="margin-bottom: 0px !important;">
                                                <div class="col-md-6">
                                                    <label>Nama Perusahaan<span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                    <input type="text" class="form-control" id="senderCompanyName" name="senderCompanyName" required>
                                                </div>
                                            </div>
                                            <div class="form-group row" style="margin-bottom: 0px !important;">
                                                <div class="col-md-11">
                                                    <label>Alamat <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                    <textarea class="form-control" id="senderAddress" name="senderAddress" required></textarea>
                                                </div>
                                            </div>*@
                                            <div class="form-group row" style="margin-bottom: 0px;margin-top: 0px;">
                                                <div class="col-8 col-md-6 col-sm-10">
                                                    <label>@(en != null ? "To" : "Kepada")<span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                    <input type="text" class="form-control" placeholder="" autocomplete="off" id="checkerPenerima_0" name="checkerPenerima_0" required="" onkeyup="load_data_penerima(this.value,0)">
                                                    <span id="search_resultPenerima_0"></span>
                                                    <input type="hidden" class="form-control" id="idUserCheckerPenerima_0" name="idUserCheckerPenerima">
                                                    <input type="hidden" class="form-control" id="idPositionCheckerPenerima_0" name="idPositionCheckerPenerima">
                                                    <input type="hidden" class="form-control" id="idLevelCheckerPenerima_0" name="idLevelCheckerPenerima">
                                                    <input type="hidden" class="form-control" id="idUnitCheckerPenerima_0" name="idUnitCheckerPenerima">
                                                </div>
                                                <div class="col-4 col-md-6 col-sm-2">
                                                    <label>&nbsp;</label>
                                                    <input type="button" value="+" id="btnAddReceiver" onclick="AddTextBoxCheckerPenerima()" class="btn btn-success" style="display:block">
                                                </div>
                                            </div>
                                            <div id="TextBoxContainerCheckerPenerima">
                                                <!--Textboxes will be added here -->
                                            </div>

                                            <div class="form-group row" style="margin-bottom: 0px;margin-top: 0px;">
                                                <div class="col-8 col-md-6 col-sm-10">
                                                    <label>@(en != null ? "Cc" : "Tembusan")</label>
                                                    <input type="text" class="form-control" placeholder="" autocomplete="off" id="checkerCarbonCopy_0" name="checkerCarbonCopy_0" required="" onkeyup="load_data_carboncopy(this.value,0)">
                                                    <span id="search_resultCarbonCopy_0"></span>
                                                    <input type="hidden" class="form-control" id="idUserCheckerCarbonCopy_0" name="idUserCheckerCarbonCopy">
                                                    <input type="hidden" class="form-control" id="idPositionCheckerCarbonCopy_0" name="idPositionCheckerCarbonCopy">
                                                    <input type="hidden" class="form-control" id="idLevelCheckerCarbonCopy_0" name="idLevelCheckerCarbonCopy">
                                                    <input type="hidden" class="form-control" id="idUnitCheckerCarbonCopy_0" name="idUnitCheckerCarbonCopy">
                                                </div>
                                                <div class="col-4 col-md-6 col-sm-2">
                                                    <label>&nbsp;</label>
                                                    <input type="button" value="+" id="btnAddReceiver" onclick="AddTextBoxCheckerCarbonCopy()" class="btn btn-success" style="display:block">
                                                </div>
                                            </div>
                                            <div id="TextBoxContainerCheckerCarbonCopy">
                                                <!--Textboxes will be added here -->
                                            </div>
                                        </fieldset>
                                        <br />
                                     
                                        <fieldset>
                                            <div class="form-group row" style="margin-bottom: 0px;margin-top: 0px;">
                                                <div class="col-8 col-md-6 col-sm-10">
                                                    <legend style="font-size: 10pt"><b>@(en != null ? "Approver" : "Persetujuan")</b><span aria-hidden="true" class="required" style="color: red;">*</span></legend>
                                                    <input type="text" class="form-control" autocomplete="off" placeholder="" id="checkerApprover_0" name="checkerApprover_0" required="" onkeyup="load_data_Approver(this.value,0)">
                                                    <span id="search_resultApprover_0"></span>
                                                    <input type="hidden" class="form-control" id="idUserApprover_0" name="idUserApprover">
                                                    <input type="hidden" class="form-control" id="idPositionApprover_0" name="idPositionApprover">
                                                    <input type="hidden" class="form-control" id="idLevelApprover_0" name="idLevelApprover">
                                                    <input type="hidden" class="form-control" id="idUnitApprover_0" name="idUnitApprover">
                                                </div>
                                                <div class="col-4 col-md-6 col-sm-2">
                                                    <label>&nbsp;</label>
                                                    <input type="button" value="+" id="btnAddApprover" onclick="AddTextBoxCheckerApprover()" class="btn btn-success" style="display:block">
                                                </div>
                                            </div>
                                            <div id="TextBoxContainerCheckerApprover">
                                                <!--Textboxes will be added here -->
                                            </div>
                                        </fieldset>
                                            <br />
                                        <fieldset>
                                            @*<legend style="font-size: 10pt"><b>@(en != null ? "Checker" : "Pemeriksa")</b><span aria-hidden="true" class="required" style="color: red;">*</span></legend>*@
                                            <legend style="font-size: 10pt"><b>@(en != null ? "Checker" : "Pemeriksa")</b></legend>
                                            <div class="form-group row" style="margin-bottom: 0px;margin-top: 0px;">
                                                <div class="col-8 col-md-6 col-sm-10">
                                                    <label>&nbsp;</label>
                                                    <input type="text" class="form-control" autocomplete="off" placeholder="Pemeriksa" id="checker_0" name="checker_0" required="" onkeyup="load_data_pemeriksa(this.value,0)">
                                                    <span id="search_result_0"></span>
                                                    <input type="hidden" class="form-control" id="idUserChecker_0" name="idUserChecker">
                                                    <input type="hidden" class="form-control" id="idPositionChecker_0" name="idPositionChecker">
                                                    <input type="hidden" class="form-control" id="idLevelChecker_0" name="idLevelChecker">
                                                    <input type="hidden" class="form-control" id="idUnitChecker_0" name="idUnitChecker">
                                                </div>
                                                <div class="col-4 col-md-6 col-sm-2">
                                                    <label>&nbsp;</label>
                                                    <input type="button" value="+" id="btnAddChecker" onclick="AddTextBoxChecker()" class="btn btn-success" style="display:block">
                                                </div>
                                            </div>
                                            <div id="TextBoxContainerChecker">
                                                <!--Textboxes will be added here -->
                                            </div>
                                        </fieldset>
                                        <br />
                                        <fieldset>
                                            <legend style="font-size: 10pt"><b>@(en != null ? "Checker Others" : "Pemeriksa lainnya")</b></legend>
                                            <div class="form-group row" style="margin-bottom: 0px;margin-top: 0px;">
                                                <div class="col-8 col-md-6 col-sm-10">
                                                    <label>&nbsp;</label>
                                                    <input type="text" class="form-control" autocomplete="off" placeholder="Pemeriksa lainnya" id="checkerlain_0" name="checkerlain_0" required="" onkeyup="load_data_pemeriksalain(this.value,0)">
                                                    <span id="search_resultlain_0"></span>
                                                    <input type="hidden" class="form-control" id="idUserCheckerlain_0" name="idUserCheckerlain">
                                                    <input type="hidden" class="form-control" id="idPositionCheckerlain_0" name="idPositionCheckerlain">
                                                    <input type="hidden" class="form-control" id="idLevelCheckerlain_0" name="idLevelCheckerlain">
                                                    <input type="hidden" class="form-control" id="idUnitCheckerlain_0" name="idUnitCheckerlain">
                                                </div>
                                                <div class="col-4 col-md-6 col-sm-2">
                                                    <label>&nbsp;</label>
                                                    <input type="button" value="+" id="btnAddCheckerlain" onclick="AddTextBoxCheckerlain()" class="btn btn-success" style="display:block">
                                                </div>
                                            </div>
                                            <div id="TextBoxContainerCheckerlain">
                                                <!--Textboxes will be added here -->
                                            </div>
                                        </fieldset>
                                        <br />
                                        <fieldset>
                                            <div class="form-group row" style="margin-bottom: 0px;margin-top: 0px;">
                                                <div class="col-8 col-md-6 col-sm-10">
                                                    <legend style="font-size: 10pt"><b>@(en != null ? "Deliberation" : "Deliberasi")</b></legend>
                                                    <input type="text" class="form-control" autocomplete ="off" placeholder="" id="checkerDelibretion_0" name="checkerDelibretion_0" required="" onkeyup="load_data_delibretion(this.value,0)">
                                                    <span id="search_resultDelibretion_0"></span>
                                                    <input type="hidden" class="form-control" id="idUserCheckerDelibretion_0" name="idUserCheckerDelibretion">
                                                    <input type="hidden" class="form-control" id="idPositionCheckerDelibretion_0" name="idPositionCheckerDelibretion">
                                                    <input type="hidden" class="form-control" id="idLevelCheckerDelibretion_0" name="idLevelCheckerDelibretion">
                                                    <input type="hidden" class="form-control" id="idUnitCheckerDelibretion_0" name="idUnitCheckerDelibretion">
                                                </div>
                                                <div class="col-4 col-md-6 col-sm-2">
                                                    <label>&nbsp;</label>
                                                    <input type="button" value="+" id="btnAddReceiver" onclick="AddTextBoxCheckerDelibration()" class="btn btn-success" style="display:block">
                                                </div>
                                            </div>
                                            <div id="TextBoxContainerCheckerDelibretion">
                                                <!--Textboxes will be added here -->
                                            </div>
                                        </fieldset>


                                    </div>
                                </div>
                                <div class="kt-inbox__primary" id="alltemplate" align="Center" style="display: marker;overflow-x: auto;white-space: nowrap;max-width: 100%;margin-left: 1%;margin-right: 1%;">
                                    <br>
                                    @foreach (var item in ViewBag.TemplateData)
                                    {
                                        <div class="btn-group">
                                            <button type="button" class="btn btn-success btn-bold" data-toggle="modal" data-target="#template_@noTemplate">
                                                <i class="flaticon2-checking">&nbsp;@item.templateName</i>
                                            </button>
                                        </div>
                                        <div class="modal fade" id="template_@noTemplate" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel2" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="exampleModalLabel2">@item.templateName</h5>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body" style="text-align: center;">
                                                        <textarea class="data_template">@HttpUtility.HtmlDecode(item.templateContent)</textarea>
                                                    </div>
                                                    <div class="modal-footer test">
                                                        <div style='float: left;'>
                                                            <button type="button" onclick="ganti_template('@item.idContentTemplate',@noTemplate)" class="btn btn-success flaticon-list">&nbsp;Pilih</button>
                                                        </div>
                                                        <div style='float: right;'>
                                                            <button type="button" class="btn btn-danger flaticon-close" data-dismiss="modal">&nbsp;Close</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        noTemplate++;
                                    }

                                </div>
                                <div class="col-md-12" style="padding-top: 2%;">
                                    <div class="tinymce">
                                        <textarea id="isiSurat" name="isiSurat">
                                        <p>&nbsp;</p>
                                        </textarea>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group row" style="width: 100%">
                                        <label class="col-lg-3 col-form-label">@(en != null ? "Upload File Attachment:" : "Unggah Lampiran File:")</label>
                                        <div class="col-lg-12">
                                            <div class="kt-uppy dropzone" id="dropss" width="100%" style="height: 100px;">
                                            </div>
                                            <span class="form-text text-muted">File type: JPG, PNG, DOC, DOCX, XLS, XLSX, PDF(Maksimal 15MB)</span>
                                        </div>
                                    </div>
                                </div>
                               @* <div class="col-md-3">
                                    <div class="form-group row" style="width: 100%">
                                        <div class="btn-group col-sm-2">
                                            <button type="button" class="btn btn-warning btn-bold" id="btnPreview">
                                                <i class="flaticon2-checking">&nbsp;Preview</i>
                                            </button>
                                        </div>
                                    </div>
                                </div>*@
                                <div class="col-md-6">
                                    <div class="form-group row" style="width: 100%">
                                        <label class="col-lg-3 col-form-label">@(en != null ? "Summary:" : "Ringkasan:") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                        <div class="col-lg-12">
                                            <textarea class="form-control" id="summary" name="summary" cols="45" rows="3" required></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group row" style="width: 100%">
                                        <label class="col-lg-3 col-form-label">@(en != null ? "Comment:" : "Komentar:") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                        <div class="col-lg-12">
                                            <textarea class="form-control" id="comment" name="comment" cols="45" rows="3" required></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="kt-inbox__foot" style="padding-bottom: 2%;">
                                    <div class="kt-inbox__primary">
                                        <div class="btn-group col-sm-2">
                                            <button type="button" class="btn btn-success btn-bold" onclick="saveSurat(1)">
                                                <i class="flaticon-paper-plane-1">&nbsp;@(en != null ? "Save" : "Simpan")</i>
                                            </button>
                                        </div>
                                        <div class="btn-group col-sm-2">
                                            <button type="button" class="btn btn-warning btn-bold" style="color: white;" onclick="saveSurat(2)">
                                                <i class="flaticon-paper-plane-1">&nbsp;@(en != null ? "Send" : "Kirim")</i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/assets/tinymcepack/tinymce.js?v=7.3.0" type="text/javascript"></script>
<link href="~/assets/demo/demo2/new_theme/css/dropzone.css" rel="stylesheet" type="text/css" />
<script src="~/assets/demo/demo2/new_theme/js/dropzone.js" type="text/javascript"></script>
<script type="text/javascript">
    var orderKepada = 0;
    var orderPemeriksa = 0;
    var orderPenerima =0;
    var orderCarbonCopy=0;
    var orderDelebrtion=0;
    var orderApprover=0;
    var orderPemeriksalain = 0;
    $(document).ready(function () {
        var ordersKepada = @orderkepada+1;
        var ordersPemeriksa = @orderpemeriksa+1;
        var ordersPenerima = @orderpenerima+1;
        var ordersCarbonCopy = @ordercarboncopy+1;
        var ordersDelibrations = @orderdelibretion+1;
        var ordersApprover = @orderApprover+1;
        var ordersPemeriksalain = @orderpemeriksalain+1;
        
        orderKepada = ordersKepada;
        orderPemeriksa = ordersPemeriksa;
        orderPenerima = ordersPenerima;
        orderCarbonCopy = ordersCarbonCopy;
        orderDelibration = ordersDelibrations;
        orderApprover = ordersApprover;
        orderPemeriksalain = ordersPemeriksalain;

    });




    $("#receiver_0").autocomplete({
        minLength: 3,
        source: function (req, res) {
            console.log(req, res);
            $.ajax({
                url: "@Url.Action("GetUserReceiver","BackDate")",
                method: "POST",
                data: { keyword: req.term },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    var d = $.map(data, function (row) {
                        return {
                            label: row.userName + " - " + row.positionName,
                            value: row.idUser
                        }
                    });
                    res(d);
                }
            });
        },
        focus: function (event, ui) {
            $("#receiver_0").val(ui.item.label);
            $("#idUserReceiver_0").val(ui.item.value);

            return false;
        },
        select: function (event, ui) {
            // prevent autocomplete from updating the textbox
            //console.log('select', ui);
            //event.preventDefault();
            $("#receiver_0").val(ui.item.label);
            $("#idUserReceiver_0").val(ui.item.value);

            return false;
        }

    });

    function AddTextBoxChecker() {
        var html = "<div id='divDispo" + orderPemeriksa + "' class='form-group row' style='margin-bottom: 0px;margin-top: 0px;'> <div class='col-8 col-md-6 col-sm-10'> <label>&nbsp;</label> <input type='text' class='form-control' id='checker_" + orderPemeriksa + "' name='checker_" + orderPemeriksa + "' placeholder='' autocomplete='off' required='' onkeyup='load_data_pemeriksa(this.value," + orderPemeriksa + ")'><span id='search_result_" + orderPemeriksa + "'></span> <input type='hidden' class='form-control idUserChecker' id='idUserChecker_" + orderPemeriksa + "' name='idUserChecker'> <input type='hidden' class='form-control idPositionChecker' id='idPositionChecker_" + orderPemeriksa + "' name='idPositionChecker'><input type='hidden' class='form-control idPositionChecker' id='idLevelChecker_" + orderPemeriksa + "' name='idLevelChecker'><input type='hidden' class='form-control' id='idUnitChecker_" + orderPemeriksa + "' name='idUnitChecker'> </div>  <div class='col-4 col-md-6 col-sm-2'> <label>&nbsp;</label> <input type='button' value='-' id='btnRemoveChecker' onclick='RemoveTextBoxChecker(" + orderPemeriksa + ")' class='btn btn-warning' style='display:block'> </div> </div>";
        $('#TextBoxContainerChecker').append(html);

        orderPemeriksa++;
    }
    //function AddTextBoxReceiver() {
    //    var html = "<div id='divReceiver" + orderKepada + "' class='form-group row' style='margin-bottom: 0px;margin-top: 0px;'> <div class='col-8 col-md-6 col-sm-10'> <label>&nbsp;</label> <input type='text' class='form-control' id='senderName' name='senderName' placeholder='' autocomplete='off' required=''> </div>  <div class='col-4 col-md-6 col-sm-2'> <label>&nbsp;</label> <input type='button' value='-' id='btnRemoveReceiver' onclick='RemoveTextBoxReceiver(" + orderKepada + ")' class='btn btn-warning' style='display:block'> </div> </div>";
    //    $('#TextBoxContainerReceiver').append(html);
    //    orderKepada++;
    //}
    function RemoveTextBoxChecker(idDiv) {
        $("#divDispo" + idDiv).remove();
    }
    function RemoveTextBoxReceiver(idDiv) {
        $("#divReceiver" + idDiv).remove();
    }
    function load_data(keyword, number) {
        if (keyword.length >= 3) {
            $.ajax({
                url: "@Url.Action("GetUserReceiver","BackDate")",
                method: "POST",
                data: { keyword: keyword },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    var html = '<div class="list-group">';
                    for (var i = 0; i < data.length; i++) {
                        var value = data[i].idUser + " - " + data[i].idPosition + " - " + data[i].idUnit;
                        var text = data[i].userName + " - " + data[i].positionName;
                        if (number == 1000) {
                            text = data[i].nip + " - " + data[i].positionName + " - " + data[i].userName;
                        }
                        html += '<div class="list-group-item list-group-item-action" onclick="get_text(\'' + text + '\',' + number + ',\'' + value + '\',' + data[i].idLevel + ')">' + text + '</div>';
                    }
                    html += '</div>';
                    if (number != 1000) {
                        document.getElementById('search_result_' + number).innerHTML = html;
                    } else {
                        document.getElementById('search_result_sender').innerHTML = html;
                    }

                }
            });
        }
        else {
            if (number != 1000) {
                document.getElementById('search_result_' + number).innerHTML = '';
            } else {
                document.getElementById('search_result_sender').innerHTML = '';
            }
        }
    }
    function load_data_pemeriksa(keyword, number) {
        if (keyword.length >= 3) {
            $.ajax({
                url: "@Url.Action("GetUserCopy","BackDate")",
                method: "POST",
                data: { keyword: keyword },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    var html = '<div class="list-group">';
                    for (var i = 0; i < data.length; i++) {
                        var value = data[i].idUser + " - " + data[i].idPosition + " - " + data[i].idUnit;
                        var text = data[i].userName + " - " + data[i].positionName;
                        if (number == 1000) {
                            text = data[i].nip + " - " + data[i].positionName + " - " + data[i].userName;
                        }
                        html += '<div class="list-group-item list-group-item-action" onclick="get_text(\'' + text + '\',' + number + ',\'' + value + '\',' + data[i].idLevel + ')">' + text + '</div>';
                    }
                    html += '</div>';
                    if (number != 1000) {
                        document.getElementById('search_result_' + number).innerHTML = html;
                    } else {
                        document.getElementById('search_result_sender').innerHTML = html;
                    }

                }
            });
        }
        else {
            if (number != 1000) {
                document.getElementById('search_result_' + number).innerHTML = '';
            } else {
                document.getElementById('search_result_sender').innerHTML = '';
            }
        }
    }
    function get_text(text, number, value, level) {
        console.log('value : ', text);
        var splitValue = value.split(" - ");
        var splitText = text.split(" - ");
        if (number != 1000) {
            document.getElementById('checker_' + number).value = text;
            document.getElementById('idUserChecker_' + number).value = splitValue[0];
            document.getElementById('idPositionChecker_' + number).value = splitValue[1];
            document.getElementById('idUnitChecker_' + number).value = splitValue[2];
            document.getElementById('idLevelChecker_' + number).value = level;
            document.getElementById('search_result_' + number).innerHTML = '';
        } else {
            document.getElementById('nipBoss').value = splitText[0];
            document.getElementById('bossPositionName').value = splitText[1];
            document.getElementById('bossName').value = splitText[2];
            document.getElementById('bossUserId').value = splitValue[0];
            document.getElementById('bossPositionId').value = splitValue[1];
            document.getElementById('bossUnitId').value = splitValue[2];
            document.getElementById('bossLevelId').value = level;
            document.getElementById('search_result_sender').innerHTML = '';
        }

    }


    //Type Memo

    function getTipeMemo(outboxType) {
        $('#idMemoType option:not(:first)').remove();
        //var JenissMemoValue = outboxType.split(",");
        //console.log(JenissMemoValue[0]);
        $.ajax({
            url: "@Url.Action("GetTypeMemo","BackDate")",
            method: "POST",
            //data: { JenissMemoValue: JenissMemoValue[0] },
            data: { outboxType: outboxType },
            success: function (msg) {
                var data = JSON.parse(msg);
                var result = data.Result;
                console.log(data.Result);
                for (var i = 0; i < result.length; i++) {
                    $("#idMemoType").append('<option value="' + result[i].idmemotype + '">' + result[i].memotypename + '</option>');
                    //$('#approvalP').val($('#approvalP').val() + result[i].idPengadaan);
                }


            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert("ERROR!!!");
            }
        });
    }

    //end


    // pemeriksalainya

    function AddTextBoxCheckerlain() {
        var html = "<div id='divDispolain" + orderPemeriksalain + "' class='form-group row' style='margin-bottom: 0px;margin-top: 0px;'> <div class='col-8 col-md-6 col-sm-10'> <label>&nbsp;</label> <input type='text' class='form-control' id='checkerlain_" + orderPemeriksalain + "' name='checkerlain_" + orderPemeriksalain + "' placeholder='' autocomplete='off' required='' onkeyup='load_data_pemeriksalain(this.value," + orderPemeriksalain + ")'><span id='search_resultlain_" + orderPemeriksalain + "'></span> <input type='hidden' class='form-control idUserCheckerlain' id='idUserCheckerlain_" + orderPemeriksalain + "' name='idUserCheckerlain'> <input type='hidden' class='form-control idPositionCheckerlain' id='idPositionCheckerlain_" + orderPemeriksalain + "' name='idPositionCheckerlain'><input type='hidden' class='form-control idPositionCheckerlain' id='idLevelCheckerlain_" + orderPemeriksalain + "' name='idLevelCheckerlain'><input type='hidden' class='form-control' id='idUnitCheckerlain_" + orderPemeriksalain + "' name='idUnitCheckerlain'> </div>  <div class='col-4 col-md-6 col-sm-2'> <label>&nbsp;</label> <input type='button' value='-' id='btnRemoveCheckerLain' onclick='RemoveTextBoxCheckerlain(" + orderPemeriksalain + ")' class='btn btn-warning' style='display:block'> </div> </div>";
        $('#TextBoxContainerCheckerlain').append(html);

        orderPemeriksalain++;
    }

    function RemoveTextBoxCheckerlain(idDiv) {
        $("#divDispolain" + idDiv).remove();
    }

    function load_data_pemeriksalain(keyword, number) {
        if (keyword.length >= 3) {
            $.ajax({
                url: "@Url.Action("GetDataPemeriksaDivLainya","Memo")",
                method: "POST",
                data: { keyword: keyword },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    var html = '<div class="list-group">';
                    for (var i = 0; i < data.length; i++) {
                        var value = data[i].idUser + " - " + data[i].idPosition + " - " + data[i].idUnit;
                        var text = data[i].userName + " - " + data[i].positionName;
                        if (number == 1000) {
                            text = data[i].nip + " - " + data[i].positionName + " - " + data[i].userName;
                        }
                        html += '<div class="list-group-item list-group-item-action" onclick="get_textlain(\'' + text + '\',' + number + ',\'' + value + '\',' + data[i].idLevel + ')">' + text + '</div>';
                    }
                    html += '</div>';
                    if (number != 1000) {
                        document.getElementById('search_resultlain_' + number).innerHTML = html;
                    } else {
                        document.getElementById('search_result_sender').innerHTML = html;
                    }

                }
            });
        }
        else {
            if (number != 1000) {
                document.getElementById('search_resultlain_' + number).innerHTML = '';
            } else {
                document.getElementById('search_result_sender').innerHTML = '';
            }
        }
    }

    function get_textlain(text, number, value, level) {
        console.log('value : ', text);
        var splitValue = value.split(" - ");
        var splitText = text.split(" - ");
        if (number != 1000) {
            document.getElementById('checkerlain_' + number).value = text;
            document.getElementById('idUserCheckerlain_' + number).value = splitValue[0];
            document.getElementById('idPositionCheckerlain_' + number).value = splitValue[1];
            document.getElementById('idUnitCheckerlain_' + number).value = splitValue[2];
            document.getElementById('idLevelCheckerlain_' + number).value = level;
            document.getElementById('search_resultlain_' + number).innerHTML = '';
        }
        //else {
        //    document.getElementById('nipBoss').value = splitText[0];
        //    document.getElementById('bossPositionName').value = splitText[1];
        //    document.getElementById('bossName').value = splitText[2];
        //    document.getElementById('bossUserId').value = splitValue[0];
        //    document.getElementById('bossPositionId').value = splitValue[1];
        //    document.getElementById('bossUnitId').value = splitValue[2];
        //    document.getElementById('bossLevelId').value = level;
        //    document.getElementById('search_result_sender').innerHTML = '';
        //}

    }

    //end



    //To
    function AddTextBoxCheckerPenerima() {
        var html = "<div id='divDispoPenerima" + orderPenerima + "' class='form-group row' style='margin-bottom: 0px;margin-top: 0px;'> <div class='col-8 col-md-6 col-sm-10'> <label>&nbsp;</label> <input type='text' class='form-control' id='checkerPenerima_" + orderPenerima + "' name='checkerPenerima_" + orderPenerima + "' placeholder='' autocomplete='off' required='' onkeyup='load_data_penerima(this.value," + orderPenerima + ")'><span id='search_resultPenerima_" + orderPenerima + "'></span> <input type='hidden' class='form-control idUserCheckerPenerima' id='idUserCheckerPenerima_" + orderPenerima + "' name='idUserCheckerPenerima'> <input type='hidden' class='form-control idPositionCheckerPenerima' id='idPositionCheckerPenerima_" + orderPenerima + "' name='idPositionCheckerPenerima'><input type='hidden' class='form-control idPositionCheckerPenerima' id='idLevelCheckerPenerima_" + orderPenerima + "' name='idLevelCheckerPenerima'><input type='hidden' class='form-control' id='idUnitCheckerPenerima_" + orderPenerima + "' name='idUnitCheckerPenerima'> </div>  <div class='col-4 col-md-6 col-sm-2'> <label>&nbsp;</label> <input type='button' value='-' id='btnRemoveChecker' onclick='RemoveTextBoxCheckerPenerima(" + orderPenerima + ")' class='btn btn-warning' style='display:block'> </div> </div>";
        $('#TextBoxContainerCheckerPenerima').append(html);

        orderPenerima++;
    }

    function RemoveTextBoxCheckerPenerima(idDiv) {
        $("#divDispoPenerima" + idDiv).remove();
    }

    function load_data_penerima(keyword, number) {
        if (keyword.length >= 3) {
            $.ajax({
                url: "@Url.Action("GetUserCopy","BackDate")",
                method: "POST",
                data: { keyword: keyword },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    var html = '<div class="list-group">';
                    for (var i = 0; i < data.length; i++) {
                        var value = data[i].idUser + " - " + data[i].idPosition + " - " + data[i].idUnit;
                        var text = data[i].userName + " - " + data[i].positionName;
                        if (number == 1000) {
                            text = data[i].nip + " - " + data[i].positionName + " - " + data[i].userName;
                        }
                        html += '<div class="list-group-item list-group-item-action" onclick="get_text_penerima(\'' + text + '\',' + number + ',\'' + value + '\',' + data[i].idLevel + ')">' + text + '</div>';
                    }
                    html += '</div>';
                    if (number != 1000) {
                        document.getElementById('search_resultPenerima_' + number).innerHTML = html;
                    } 
                    else {
                        document.getElementById('search_result_sender').innerHTML = html;
                    }

                }
            });
        }
        else {
            if (number != 1000) {
                document.getElementById('search_resultPenerima_' + number).innerHTML = '';
            } else {
                document.getElementById('search_result_sender').innerHTML = '';
            }
        }
    }

    function get_text_penerima(text, number, value, level) {
        console.log('value : ', text);
        var splitValue = value.split(" - ");
        var splitText = text.split(" - ");
        if (number != 1000) {
            document.getElementById('checkerPenerima_' + number).value = text;
            document.getElementById('idUserCheckerPenerima_' + number).value = splitValue[0];
            document.getElementById('idPositionCheckerPenerima_' + number).value = splitValue[1];
            document.getElementById('idUnitCheckerPenerima_' + number).value = splitValue[2];
            document.getElementById('idLevelCheckerPenerima_' + number).value = level;
            document.getElementById('search_resultPenerima_' + number).innerHTML = '';
        } 
        //else {
        //    document.getElementById('nipBoss').value = splitText[0];
        //    document.getElementById('bossPositionName').value = splitText[1];
        //    document.getElementById('bossName').value = splitText[2];
        //    document.getElementById('bossUserId').value = splitValue[0];
        //    document.getElementById('bossPositionId').value = splitValue[1];
        //    document.getElementById('bossUnitId').value = splitValue[2];
        //    document.getElementById('bossLevelId').value = level;
        //    document.getElementById('search_result_sender').innerHTML = '';
        //}

    }
    
    // end to

    // cc
    function AddTextBoxCheckerCarbonCopy() {
        var html = "<div id='divDispoCarbonCopy" + orderCarbonCopy + "' class='form-group row' style='margin-bottom: 0px;margin-top: 0px;'> <div class='col-8 col-md-6 col-sm-10'> <label>&nbsp;</label> <input type='text' class='form-control' id='checkerCarbonCopy_" + orderCarbonCopy + "' name='checkerCarbonCopy_" + orderCarbonCopy + "' placeholder='' autocomplete='off' required='' onkeyup='load_data_carboncopy(this.value," + orderCarbonCopy + ")'><span id='search_resultCarbonCopy_" + orderCarbonCopy + "'></span> <input type='hidden' class='form-control idUserCheckerCarbonCopy' id='idUserCheckerCarbonCopy_" + orderCarbonCopy + "' name='idUserCheckerCarbonCopy'> <input type='hidden' class='form-control idPositionCheckerCarbonCopy' id='idPositionCheckerCarbonCopy_" + orderCarbonCopy + "' name='idPositionCheckerCarbonCopy'><input type='hidden' class='form-control idPositionChecker' id='idLevelCheckerCarbonCopy_" + orderCarbonCopy + "' name='idLevelCheckerCarbonCopy'><input type='hidden' class='form-control' id='idUnitCheckerCarbonCopy_" + orderCarbonCopy + "' name='idUnitCheckerCarbonCopy'> </div>  <div class='col-4 col-md-6 col-sm-2'> <label>&nbsp;</label> <input type='button' value='-' id='btnRemoveChecker' onclick='RemoveTextBoxCheckerCarbonCopy(" + orderCarbonCopy + ")' class='btn btn-warning' style='display:block'> </div> </div>";
        $('#TextBoxContainerCheckerCarbonCopy').append(html);

        orderCarbonCopy++;
    }

    function RemoveTextBoxCheckerCarbonCopy(idDiv) {
        $("#divDispoCarbonCopy" + idDiv).remove();
    }

    function load_data_carboncopy(keyword, number) {
        if (keyword.length >= 3) {
            $.ajax({
                url: "@Url.Action("GetUserCopy","BackDate")",
                method: "POST",
                data: { keyword: keyword },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    var html = '<div class="list-group">';
                    for (var i = 0; i < data.length; i++) {
                        var value = data[i].idUser + " - " + data[i].idPosition + " - " + data[i].idUnit;
                        var text = data[i].userName + " - " + data[i].positionName;
                        if (number == 1000) {
                            text = data[i].nip + " - " + data[i].positionName + " - " + data[i].userName;
                        }
                        html += '<div class="list-group-item list-group-item-action" onclick="get_text_carboncopy(\'' + text + '\',' + number + ',\'' + value + '\',' + data[i].idLevel + ')">' + text + '</div>';
                    }
                    html += '</div>';
                    if (number != 1000) {
                        document.getElementById('search_resultCarbonCopy_' + number).innerHTML = html;
                    } 
                    else {
                        document.getElementById('search_result_sender').innerHTML = html;
                    }

                }
            });
        }
        else {
            if (number != 1000) {
                document.getElementById('search_resultCarbonCopy_' + number).innerHTML = '';
            } else {
                document.getElementById('search_result_sender').innerHTML = '';
            }
        }
    }

    function get_text_carboncopy(text, number, value, level) {
        console.log('value : ', text);
        var splitValue = value.split(" - ");
        var splitText = text.split(" - ");
        if (number != 1000) {
            document.getElementById('checkerCarbonCopy_' + number).value = text;
            document.getElementById('idUserCheckerCarbonCopy_' + number).value = splitValue[0];
            document.getElementById('idPositionCheckerCarbonCopy_' + number).value = splitValue[1];
            document.getElementById('idUnitCheckerCarbonCopy_' + number).value = splitValue[2];
            document.getElementById('idLevelCheckerCarbonCopy_' + number).value = level;
            document.getElementById('search_resultCarbonCopy_' + number).innerHTML = '';
        }

    }
    
    // end cc



    // delibration
    function AddTextBoxCheckerDelibration() {
        var html = "<div id='divDispoDelibretion" + orderDelibration + "' class='form-group row' style='margin-bottom: 0px;margin-top: 0px;'> <div class='col-8 col-md-6 col-sm-10'> <label>&nbsp;</label> <input type='text' class='form-control' id='checkerDelibretion_" + orderDelibration + "' name='checkerDelibretion_" + orderDelibration + "' placeholder='' autocomplete='off' required='' onkeyup='load_data_delibretion(this.value," + orderDelibration + ")'><span id='search_resultDelibretion_" + orderDelibration + "'></span> <input type='hidden' class='form-control idUserCheckerDelibretion' id='idUserCheckerDelibretion_" + orderDelibration + "' name='idUserCheckerDelibretion'> <input type='hidden' class='form-control idPositionCheckerDelibretion' id='idPositionCheckerDelibretion_" + orderDelibration + "' name='idPositionCheckerDelibretion'><input type='hidden' class='form-control idPositionChecker' id='idLevelCheckerDelibretion_" + orderDelibration + "' name='idLevelCheckerDelibretion'><input type='hidden' class='form-control' id='idUnitCheckerDelibretion_" + orderDelibration + "' name='idUnitCheckerDelibretion'> </div>  <div class='col-4 col-md-6 col-sm-2'> <label>&nbsp;</label> <input type='button' value='-' id='btnRemoveChecker' onclick='RemoveTextBoxCheckerDelibretion(" + orderDelibration + ")' class='btn btn-warning' style='display:block'> </div> </div>";
        $('#TextBoxContainerCheckerDelibretion').append(html);

        orderDelibration++;
    }

    function AddTextBoxCheckerApprover() {
        var html = "<div id='divDispoApprover" + orderApprover + "' class='form-group row' style='margin-bottom: 0px;margin-top: 0px;'> <div class='col-8 col-md-6 col-sm-10'> <label>&nbsp;</label> <input type='text' class='form-control' id='checkerApprover_" + orderApprover + "' name='checkerApprover_" + orderApprover + "' placeholder='' autocomplete='off' required='' onkeyup='load_data_Approver(this.value," + orderApprover + ")'><span id='search_resultApprover_" + orderApprover + "'></span> <input type='hidden' class='form-control idUserApprover' id='idUserApprover_" + orderApprover + "' name='idUserApprover'> <input type='hidden' class='form-control idPositionApprover' id='idPositionApprover_" + orderApprover + "' name='idPositionApprover'><input type='hidden' class='form-control idPositionChecker' id='idLevelApprover_" + orderApprover + "' name='idLevelApprover'><input type='hidden' class='form-control' id='idUnitApprover_" + orderApprover + "' name='idUnitApprover'> </div>  <div class='col-4 col-md-6 col-sm-2'> <label>&nbsp;</label> <input type='button' value='-' id='btnRemoveChecker' onclick='RemoveTextBoxCheckerApprover(" + orderApprover + ")' class='btn btn-warning' style='display:block'> </div> </div>";
        $('#TextBoxContainerCheckerApprover').append(html);

        orderApprover++;
    }

    function RemoveTextBoxCheckerDelibretion(idDiv) {
        $("#divDispoDelibretion" + idDiv).remove();
    }

    function RemoveTextBoxCheckerApprover(idDiv) {
        $("#divDispoApprover" + idDiv).remove();
    }

    function load_data_delibretion(keyword, number) {
        if (keyword.length >= 3) {
            $.ajax({
                url: "@Url.Action("GetUserCopy","BackDate")",
                method: "POST",
                data: { keyword: keyword },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    var html = '<div class="list-group">';
                    for (var i = 0; i < data.length; i++) {
                        var value = data[i].idUser + " - " + data[i].idPosition + " - " + data[i].idUnit;
                        var text = data[i].userName + " - " + data[i].positionName;
                        if (number == 1000) {
                            text = data[i].nip + " - " + data[i].positionName + " - " + data[i].userName;
                        }
                        html += '<div class="list-group-item list-group-item-action" onclick="get_text_delibretion(\'' + text + '\',' + number + ',\'' + value + '\',' + data[i].idLevel + ')">' + text + '</div>';
                    }
                    html += '</div>';
                    if (number != 1000) {
                        document.getElementById('search_resultDelibretion_' + number).innerHTML = html;
                    } 
                    else {
                        document.getElementById('search_result_sender').innerHTML = html;
                    }

                }
            });
        }
        else {
            if (number != 1000) {
                document.getElementById('search_resultDelibretion_' + number).innerHTML = '';
            } else {
                document.getElementById('search_result_sender').innerHTML = '';
            }
        }
    }


    function load_data_Approver(keyword, number) {
        if (keyword.length >= 3) {
            $.ajax({
                url: "@Url.Action("GetUserCopy","BackDate")",
                method: "POST",
                data: { keyword: keyword },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    var html = '<div class="list-group">';
                    for (var i = 0; i < data.length; i++) {
                        var value = data[i].idUser + " - " + data[i].idPosition + " - " + data[i].idUnit;
                        var text = data[i].userName + " - " + data[i].positionName;
                        if (number == 1000) {
                            text = data[i].nip + " - " + data[i].positionName + " - " + data[i].userName;
                        }
                        html += '<div class="list-group-item list-group-item-action" onclick="get_text_Approver(\'' + text + '\',' + number + ',\'' + value + '\',' + data[i].idLevel + ')">' + text + '</div>';
                    }
                    html += '</div>';
                    if (number != 1000) {
                        document.getElementById('search_resultApprover_' + number).innerHTML = html;
                    } 
                    else {
                        document.getElementById('search_result_sender').innerHTML = html;
                    }

                }
            });
        }
        else {
            if (number != 1000) {
                document.getElementById('search_resultApprover_' + number).innerHTML = '';
            } else {
                document.getElementById('search_result_sender').innerHTML = '';
            }
        }
    }


     function get_text_Approver(text, number, value, level) {
        console.log('value : ', text);
        var splitValue = value.split(" - ");
        var splitText = text.split(" - ");
        if (number != 1000) {
            document.getElementById('checkerApprover_' + number).value = text;
            document.getElementById('idUserApprover_' + number).value = splitValue[0];
            document.getElementById('idPositionApprover_' + number).value = splitValue[1];
            document.getElementById('idUnitApprover_' + number).value = splitValue[2];
            document.getElementById('idLevelApprover_' + number).value = level;
            document.getElementById('search_resultApprover_' + number).innerHTML = '';
        } 
       

    }

    function get_text_delibretion(text, number, value, level) {
        console.log('value : ', text);
        var splitValue = value.split(" - ");
        var splitText = text.split(" - ");
        if (number != 1000) {
            document.getElementById('checkerDelibretion_' + number).value = text;
            document.getElementById('idUserCheckerDelibretion_' + number).value = splitValue[0];
            document.getElementById('idPositionCheckerDelibretion_' + number).value = splitValue[1];
            document.getElementById('idUnitCheckerDelibretion_' + number).value = splitValue[2];
            document.getElementById('idLevelCheckerDelibretion_' + number).value = level;
            document.getElementById('search_resultDelibretion_' + number).innerHTML = '';
        } 
       

    }
    
    // end delibration


    tinymce.init({
        selector: 'textarea#isiSurat',
        height: 500,
        plugins: [
            'advlist', 'autolink', 'lists', 'link', 'image', 'charmap', 'preview',
            'anchor', 'searchreplace', 'visualblocks', 'code', 'fullscreen',
            'insertdatetime', 'media', 'table', 'help', 'wordcount'
        ],
        toolbar: 'undo redo | blocks | ' +
            'bold italic backcolor | alignleft aligncenter ' +
            'alignright alignjustify | bullist numlist outdent indent | ' +
            'removeformat | help',
        content_style: 'body { font-family:Helvetica,Arial,sans-serif; font-size:16px }'
    });
    tinymce.init({
        selector: 'textarea.data_template',
        height: 500,
        readonly: true,
        // menubar: false,
        plugins: [
            'advlist autolink lists link image charmap print preview anchor',
            'searchreplace visualblocks code fullscreen',
            'insertdatetime media table paste code help wordcount'
        ],
        toolbar: 'undo redo | formatselect | ' +
            'bold italic backcolor | alignleft aligncenter ' +
            'alignright alignjustify | bullist numlist outdent indent | help',
        // content_style: 'body { font-family:Helvetica,Arial,sans-serif; font-size:14px }'
    });

    function ganti_template(idTemplate, number) {
        if (confirm('Isi memo akan hilang apabila template dirubah, apakah ingin melanjutkan ?')) {
            var datatemplates = @Html.Raw(jsonTemplateData);
            var filter = "idContentTemplate";
            var filteredData = datatemplates.filter(function (obj) {
                return obj[filter] === idTemplate;
            });
            tinymce.get("isiSurat").setContent(filteredData[0].templateContent);
            $('#template_' + number).modal('hide');
            //console.log(filteredData);
        } else {
            return false;
        }
    }


    // memo

    

   
</script>
<script>
    Dropzone.autoDiscover = false;
    var idresponse = 0;
    var files = 0;
    var idsrtfile = 0;
    var param = files + '~' + idsrtfile;

    var myDropzone = new Dropzone("div#dropss", {
        url: "@Url.Action("SaveAttachment","BackDate")?param=" + param,
        // acceptedMimeTypes:'image/JPEG,image/jpeg,image/jpg,image/JPG,application/pdf,/application/PDF,application/doc,application/docx,application/xls,application/xlsx,application/DOC,application/DOCX,application/XLS,application/XLSX',
        autoProcessQueue: false,
        parallelUploads: 1, // Number of files process at a time (default 2)
        addRemoveLinks: true,
        maxFiles: 10,
        maxFilesize: 75,
        timeout: 30000,
        init: function () {
            this.on("addedfile", function () {
                // creates an array of the files that are in queue
                var arr = myDropzone.files.length;
                //alert(arr); // displays object and not the file name.
                document.getElementById("attachmentCount").value = arr;

            });
            this.on("removedfile", function () {
                // creates an array of the files that are in queue
                var arr = myDropzone.files.length;
                //alert(arr); // displays object and not the file name.
                document.getElementById("attachmentCount").value = arr;

            });
            this.on("success", function (file, response) {
                //alert(response);
                console.log(response);
                var res = JSON.parse(response);
                console.log(res);
                idresponse = res.idLetter;
                idsrtfile = res.idLetter;
                //alert('sukses');
                $(".dz-success-mark svg").css("background", "green");
                $(".dz-error-mark").css("display", "none");
                files += 1;
                param = files + '~' + idsrtfile;
                this.options.url = "@Url.Action("SaveAttachment","BackDate")?param=" + param;
                myDropzone.processQueue();
            });
            this.on("complete", function (file) {
                //alert(response);
                if (this.getUploadingFiles().length === 0 && this.getQueuedFiles().length === 0) {
                    $('#idresponsesurat').val(idresponse);
                    //var tipes = document.getElementById('tipe').value
                    console.log(idresponse)
                    document.forms['formSurat'].submit();
                }

            });
            this.on("error", function (file, error, xhr) {
                alert(error);
                var ficheiro = { name: file.name, status: xhr.status, statusText: xhr.statusText, erro: error.message };
                console.log(ficheiro);
            });
        }

    });
</script>
<script>
    function saveSurat(flag) {
        ;
        //console.log(flag)
        
        document.getElementById("formSurat").action = "@Url.Action("SaveLetterMemo","BackDate")";
        var outboxType = document.getElementById("outboxType").value;
        var about = document.getElementById("about").value;
        var resultType = document.getElementById("resultType").value;
        var signatureType = document.getElementById("signatureType").value;
        var bossPositionId = document.getElementById("bossPositionId").value;
        var bossUserId = document.getElementById("bossUserId").value;
        var nipBoss = document.getElementById("nipBoss").value;
        var bossName = document.getElementById("bossName").value;
        //var isiSurat = document.getElementById("isiSurat");
        var kepada = document.getElementById("checkerPenerima_0").value;
        var comment = document.getElementById("comment").value;

        if (kepada == "") {
            callAlert("Informasi penerima memo tidak boleh kosong!");
            return false;
        }
        if (bossPositionName == "" || bossPositionId == "" || bossUserId == "" || nipBoss == "" || bossName == "") {
            callAlert("Informasi pengirim memo tidak boleh kosong!");
            return false;
        }
        if (about == "") {
            callAlert("Perihal memo tidak boleh kosong!");
            return false;
        }
        //if (isiSurat == "") {
        //    callAlert("Badan memo tidak boleh kosong");
        //   return false;
        //}
        if (flag != 1) {
            if (outboxType == "") {
                callAlert("Jenis dokumen tidak boleh kosong!");
                return false;
            }
            if (resultType == "") {
                callAlert("Hasil memo tidak boleh kosong!");
                return false;
            }
            if (signatureType == "") {
                callAlert("Tanda tangan memo tidak boleh kosong!");
                return false;
            }
            if (comment == "") {
                callAlert("Komentar memo tidak boleh kosong!");
                return false;
            }
            //if (isiSurat == "") {
            //    callAlert("Badan memo tidak boleh kosong");
            //    return false;
            //}
        }

        var message = "Anda yakin ingin mengirim memo ini?";
        if (flag == 1) {
            message = "Anda yakin ingin menyimpan memo ini?";
        }
        var conf = confirm(message);
        tinyMCE.triggerSave();
        if (conf == true) {
            $('#saveType').val(flag);
            if (myDropzone.files.length == 0) {
                document.forms['formSurat'].submit();
            }
            else {
                myDropzone.processQueue();
            }
            //document.forms['eval-form'].submit();
        }
    }



    $('#btnPreview').click(function (e) {
        //e.preventDefault();
        var message = "Anda yakin ingin preview memo ini?";
        var conf = confirm(message);
        tinyMCE.triggerSave();
        $('#formSurat').attr('asp-action', 'SavePrevMemoLetter');
        $('#formSurat').attr('action', '/Memo/SavePrevMemoLetter');
        if (conf == true) {
            $.blockUI({
                css: {
                    border: 'none',
                    padding: '15px',
                    backgroundColor: '#000',
                    '-webkit-border-radius': '10px',
                    '-moz-border-radius': '10px',
                    opacity: .5,
                    color: '#fff'
                }
            });
            $('#saveType').val(3);
            var form = $(this).closest('form');
            form.ajaxSubmit({
                success: function (response, status, xhr, $form) {
                    console.log(response);
                    var data = JSON.parse(response);
                    $.unblockUI();
                    if (data.Status == "OK") {
                        Swal.fire({
                            position: 'center',
                            icon: 'success',
                            title: data.Message,
                            text: data.Message,
                            showConfirmButton: true,
                            //timer: 1500,
                            onBeforeOpen: () => {
                                timerInterval = setInterval(() => {
                                    const content = Swal.getContent()
                                    if (content) {
                                        const b = content.querySelector('b')
                                        if (b) {
                                            b.textContent = Swal.getTimerLeft()
                                        }
                                    }
                                }, 100)
                            },
                            onClose: () => {
                                clearInterval(timerInterval)
                            }
                        }).then((result) => {
                            /* Read more about handling dismissals below */
                        })

                        //alert(data.Result);
                        //document.getElementById("btnPreview2").click = function () { window.open("Url.Action("PrintLetter","BackDate")/" + data.Result) };
                        printSurat(data.Result);
                        setTimeout(function () {
                            //your code to be executed after 1 second
                            window.location = "@Url.Action("DraftMemo","BackDate")";
                        }, 3000);

                    } else {
                        callAlert(data.Message);
                    }

                }
            });
        }
    });
    function printSurat(idLetter) {
        window.open("@Url.Action("PrintLetter","BackDate")/" + idLetter);
    }
    function callAlert(message) {
        Swal.fire({
            position: 'center',
            icon: 'error',
            title: 'Validasi',
            text: message,
            showConfirmButton: true,
            //timer: 1500,
            onBeforeOpen: () => {
                timerInterval = setInterval(() => {
                    const content = Swal.getContent()
                    if (content) {
                        const b = content.querySelector('b')
                        if (b) {
                            b.textContent = Swal.getTimerLeft()
                        }
                    }
                }, 100)
            },
            onClose: () => {
                clearInterval(timerInterval)
            }
        }).then((result) => {
            /* Read more about handling dismissals below */
        })
    }
</script>