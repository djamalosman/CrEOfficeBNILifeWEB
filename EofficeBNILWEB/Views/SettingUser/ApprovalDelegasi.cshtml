@model IEnumerable<EofficeBNILWEB.Models.ParamGetApprovalDelegasi>
@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer localiza

@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor Accessor
@{

    var en = Accessor.HttpContext.Session.GetString("en");
    var ina = Accessor.HttpContext.Session.GetString("ina");
    var urlApproval = @Url.ActionLink("ApprovalSignature", "SettingUser");
    var urlReject = @Url.ActionLink("RejectSignature", "SettingUser");

}
<!-- begin::Body -->
<div class="m-grid__item m-grid__item--fluid m-grid m-grid--hor-desktop m-grid--desktop m-body">
    <div class="m-grid__item m-grid__item--fluid  m-grid m-grid--ver    m-container m-container--responsive m-container--xxl m-page__container">
        <div class="m-grid__item m-grid__item--fluid m-wrapper">
            <!-- BEGIN: Subheader -->
            <div class="m-subheader ">
                <div class="d-flex align-items-center">
                    <div class="mr-auto" style="color: white;">
                        <h3 class="m-subheader__title m-subheader__title--separator" style="color: white;">
                            @(en != null ? "Approval Delegasi" : "Persetujuan Delegasi")
                        </h3>
                        <ul class="m-subheader__breadcrumbs m-nav m-nav--inline">
                            <li class="m-nav__item m-nav__item--home">
                                <a href="#" class="m-nav__link m-nav__link--icon">
                                    <i class="m-nav__link-icon la la-home" style="color: white;"></i>
                                </a>
                            </li>
                            <li class="m-nav__separator" style="color: white;">
                                -
                            </li>
                            <li class="m-nav__item">
                                <a href="" class="m-nav__link">
                                    <span class="m-nav__link-text" style="color: white;">
                                        @(en != null ? "Other" : "Lainya")
                                    </span>
                                </a>
                            </li>
                            <li class="m-nav__separator" style="color: white;">
                                -
                            </li>
                            <li class="m-nav__item">
                                <a href="" class="m-nav__link">
                                    <span class="m-nav__link-text" style="color: white;">
                                        @(en != null ? "Delegasi Approval" : "Persetujuan Delegasi")
                                    </span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- END: Subheader -->
            <div class="m-content" style="padding: 30px 30px !important;">
                <!--Begin::Main Portlet-->
                
                <div class="m-portlet m-portlet--full-height ">
                    <div class="m-portlet__head">
                        <div class="m-portlet__head-caption">
                            @(en != null ? "Delegasi Approval Request Data" : "Data Permintaan Persetujuan Delegasi")
                        </div>
                    </div>
                    <div class="m-portlet__body">
                        
                        <div class="table-responsive">                          
                            <button id="btnApproval" class="btnClick" >Approval</button>
                            <button id="btnReject" class="btnClick" >Reject</button>

                            <br />
                            <br />
                            <table id="myTable" class="table table-bordered table-striped" width="100%" cellspacing="0">
                                <thead>
                                    <tr>
                                        
                                        <th >NO</th>
                                        <th style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;"><input type="checkbox" id="btnSelectAll" class="btnClick" /> <label for="btnSelectAll">Select All</label></th>
                                        <th  style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Name" : "Nama")</th>                                        
                                        <th  style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Name Delegasi" : "Nama Delegasi")</th>
                                        <th  style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Start Date" : "Tanggal Mulai")</th>
                                        <th  style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "End Date" : "Tanggal Berakhir")</th>                          
                                        <th  style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Status" : "Status")</th>
                                        @*<th>@(en != null ? "Action" : "Aksi")</th>*@
                                    </tr>
                                </thead>
                                <tbody>
                                    @{
                                        int i = 1;
                                    }
                                    @foreach (var item in ViewBag.DelegasiNew)
                                    {
                                        <tr>
                                            <td>@i</td>
                                            <td>
                                                <div class="pure-checkbox">
                                                    <input type="checkbox"   class="checktip"
                                                       checked="@(@item.Id == @item.Id ? false : true)"
                                                       name="@item.Id.ToString()" id="@item.Id.ToString()" />
                                                    @*<label for="@item.nip()"></label>*@
                                                </div>
                                            </td>
                                             <td>@item.user_name</td>
                                            <td>@item.user_name_delegasi</td>
                                            <td>@item.startdatestring</td>
                                            <td>@item.enddatestring</td>
                                           <td>@item.Status_approver </td>

                                           
                                           
                                        </tr>
                                        i++;
                                    }
                                </tbody>
                            </table>
                            
                            <div class="show">
                                <div class="overlay"></div>
                                <div class="img-show">
                                    <span></span>
                                    <img src="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--End::Main Portlet-->
                <!--Begin::Main Portlet-->

                <div class="m-portlet m-portlet--full-height ">
                    <div class="m-portlet__head">
                        <div class="m-portlet__head-caption">
                            @(en != null ? "Data Delegasi requests that were approved or rejected" : "Data Permintaan Delegasi yang disetuji atau ditolak")
                        </div>
                    </div>
                    <div class="m-portlet__body">

                        <div class="table-responsive">
                            <style>
                                .modal {
                                z-index:1;
                                display:none;
                                padding-top:10px;
                                position:fixed;
                                left:0;
                                top:0;
                                width:100%;
                                height:100%;
                                overflow:auto;
                                background-color:rgb(0,0,0);
                                background-color:rgba(0,0,0,0.8)
                                }

                                .modal-content{
                                margin: auto;
                                width: 300px;
                                /*height: 400px;*/
                                display: block;
                                    position: absolute;
                                  top: 50%;
                                  left: 50%;
                                  transform: translate(-50%, -50%);
                                  overflow: hidden
                                }

                                        
                                .modal-hover-opacity {
                                opacity:1;
                                filter:alpha(opacity=100);
                                -webkit-backface-visibility:hidden
                                }

                                .modal-hover-opacity:hover {
                                opacity:0.60;
                                filter:alpha(opacity=60);
                                -webkit-backface-visibility:hidden
                                }


                                .close {
                                text-decoration:none;float:right;font-size:24px;font-weight:bold;color:white
                                }
                                .container1 {
                                width:80px;
                                
                                display:inline-block;
                                }
                                .modal-content, #caption {   
  
                                    -webkit-animation-name: zoom;
                                    -webkit-animation-duration: 0.6s;
                                    animation-name: zoom;
                                    animation-duration: 0.6s;
                                }


                                @@webkit-keyframes zoom {
                                    from {-webkit-transform:scale(0)} 
                                    to {-webkit-transform:scale(1)}
                                }

                                @@keyframes zoom {
                                    from {transform:scale(0)} 
                                    to {transform:scale(1)}
                                }
                                  img {
                                  display: block;
                                  margin-left: auto;
                                  margin-right: auto;
                                }
                                /*End style*/
                            </style>
                            <table id="myTablee" class="display" width="100%" cellspacing="0">
                                <thead>
                                    <tr>
                                       <th >NO</th>                                       
                                        <th  style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Name" : "Nama")</th>                                        
                                        <th  style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Name Delegasi" : "Nama Delegasi")</th>
                                        <th  style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Start Date" : "Tanggal Mulai")</th>
                                        <th  style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "End Date" : "Tanggal Berakhir")</th>                          
                                        <th  style="padding-top: 10px;padding-bottom: 10px;padding-right: 18px;padding-left: 9px;">@(en != null ? "Status" : "Status")</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @{
                                        int a = 1;
                                    }
                                    @foreach (var item in ViewBag.DelegasiApprovalReject)
                                    {
                                        <tr>
                                            <td>@a</td>
                                          <td>@item.user_name</td>
                                            <td>@item.user_name_delegasi</td>
                                            <td>@item.startdatestring</td>
                                            <td>@item.enddatestring</td>
                                           <td>@item.Status_approver </td>


                                        </tr>
                                        a++;
                                    }
                                </tbody>
                            </table>
                            <div id="modal01" class="modal" onclick="this.style.display='none'">
                                <span class="close">&times;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                <div class="modal-content">
                                    <img id="img01" style="max-width:100%">
                                </div>
                            </div>
                            @*Approval dan Reject*@


                            <div class="show1">
                                <div class="overlay1"></div>
                                <div class="img-show1">
                                    <span></span>
                                    <img src="">
                                </div>
                            </div>
                        </div>
                    </div>



                </div>
                <!--End::Main Portlet-->
            </div>

            @*Approval dan Reject*@
            <div class="m-content" style="padding: 30px 30px !important;">
               
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $('#myTable').DataTable();
    })
    $(document).ready(function () {
        $('#myTablee').DataTable();
    })
    function onClick(element) {
        document.getElementById("img01").src = element.src;
        document.getElementById("modal01").style.display = "block";
    }

</script>
@section Scripts{
    <script>
        $(function () {
            //If checked the select all checkbox, select all items. else unchecked.
            $("#btnSelectAll").click(function () {
                if ($(this).is(":checked")) {
                    $(".checktip").each(function (index, item) {
                        $(item).prop("checked", true);
                    });
                   
                }
                else {
                    $(".checktip").each(function (index, item) {
                        $(item).prop("checked", false);
                    });
                }
            });

            $("#btnApproval").click(function () {
                var Approval = [];
                //using the class selector to loop through the checkbox list and get all items, if you want to get the checked items, add an if...else statement in the each function.
                $(".checktip").each(function (index, item) {
                    var ApprovalModel = {};
                    ApprovalModel.Id = $(this).attr("id");
                    //TestViewModel.idemployee = $(this).attr("data-idemployee");
                    ApprovalModel.isChecked = $(this).is(":checked");
                    Approval.push(ApprovalModel);
                });

                $.ajax({
                    //url: "/SettingUser/ApprovalSignature",  //remember change the controller to your owns.
                    url: "@Url.Action("ApprovalDelegasiUser","SettingUser")",
                    method: "Post",
                    data: { items: Approval },  //the name ("items") should be the same with the parameter's name in the controller.
                    success: function (pesan) {
                        var data = JSON.parse(pesan);
                        var result = data.Result;
                        console.log(data);
                        window.location.reload();
                    },
                    error: function (response) {
                        console.log(response.responseText);
                    }
                });
            });

            $("#btnReject").click(function () {
                var Reject = [];
                //using the class selector to loop through the checkbox list and get all items, if you want to get the checked items, add an if...else statement in the each function.
                $(".checktip").each(function (index, item) {
                    var RejectModel = {};
                    RejectModel.idMg = $(this).attr("id");
                    //TestViewModel.idemployee = $(this).attr("data-idemployee");
                    RejectModel.isChecked = $(this).is(":checked");
                    Reject.push(RejectModel);
                });

                $.ajax({
                    //type: "Post",
                    //url: "/SettingUser/RejectSignature",  //remember change the controller to your owns.
                    url: "@Url.Action("RejectSignature","SettingUser")",
                    method: "Post",
                    data: { items: Reject },  //the name ("items") should be the same with the parameter's name in the controller.
                    success: function (pesan) {
                        var data = JSON.parse(pesan);
                        var result = data.Result;
                        console.log(data);
                        window.location.reload();
                    },
                    error: function (response) {
                        console.log(response.responseText);
                    }
                });
            });

        });
    </script>
 }

