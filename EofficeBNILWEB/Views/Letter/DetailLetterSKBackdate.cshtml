@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer localiza
@model EofficeBNILWEB.Models.OutputDetailLetterBackdate
@using Microsoft.AspNetCore.Http
@using System.Web
@using Newtonsoft.Json
@inject IHttpContextAccessor Accessor
@{
    var sessidUser = Accessor.HttpContext.Session.GetString("idUser");
    Guid sessidUserGuid = new Guid(Accessor.HttpContext.Session.GetString("idUser"));
    var sessidUnit = Accessor.HttpContext.Session.GetString("idUnit");
    var sessidGroup = Accessor.HttpContext.Session.GetString("idGroup");
    Guid sessBossIdUser = new Guid();
    Guid guidEmpty = Guid.Empty;
    if (Accessor.HttpContext.Session.GetString("parentIdUser") != guidEmpty.ToString().ToUpper())
    {
        sessBossIdUser = new Guid(Accessor.HttpContext.Session.GetString("parentIdUser"));
    }
    Guid sessBossIdPosition = new Guid();
    if (Accessor.HttpContext.Session.GetString("parentIdPosition") != guidEmpty.ToString().ToUpper())
    {
        sessBossIdPosition = new Guid(Accessor.HttpContext.Session.GetString("parentIdPosition"));
    }

    var orderkepada = 0;
    var ordertembusan = 0;
    var orderdisposisi = 0;
    var orderpemeriksa = 0;
    var orderApprover = 0;

    var numButton = 0;
    var noTemplate = 1;
    var idDivKepada = "divbarukepada" + orderkepada;
    var idDivTembusan = "divbarutembusan" + ordertembusan;
    string dateNow = DateTime.Now.ToString("yyyy-MM-dd");
    string dateLetter = Convert.ToDateTime(Model.letter.letterDate).ToString("dd MMM yyyy");
    var jsonTemplateData = JsonConvert.SerializeObject(ViewBag.TemplateData);
    var currentChecker = Model.checker.Where(p => p.idUserChecker == sessidUserGuid && p.approvalStatus == 'Y').FirstOrDefault();
    var currentSekreChecker = Model.checker.Where(p => p.idPositionChecker == sessBossIdPosition && p.approvalStatus == 'Y').FirstOrDefault();
    var currentCheckerPengirim = Model.Pengirim.Where(p => p.idUserChecker == sessidUserGuid && p.approvalStatus == 'Y').FirstOrDefault();
    var currentApprover = Model.Approval.Where(p => p.idUserChecker == sessidUserGuid && p.approvalStatus == 'Y').FirstOrDefault();

    var actionForm = "SaveOutboxLetter";
    if (Model.letter.statusCode == 2)
    {
        actionForm = "ApprovalLetter";
    }
    var suratAsli = 0;
    if (Model.docLetter != null)
    {
        suratAsli = 1;
    }
    var en = Accessor.HttpContext.Session.GetString("en");
    var ina = Accessor.HttpContext.Session.GetString("ina");
}
<style>
    .tox-promotion {
        display: none !important;
    }
</style>
<!-- begin::Body -->
<div class="m-grid__item m-grid__item--fluid m-grid m-grid--hor-desktop m-grid--desktop m-body">
    <div class="m-grid__item m-grid__item--fluid  m-grid m-grid--ver    m-container m-container--responsive m-container--xxl m-page__container">
        <div class="m-grid__item m-grid__item--fluid m-wrapper">
            <!-- BEGIN: Subheader -->
            <div class="m-subheader ">
                <div class="d-flex align-items-center">
                    <div class="mr-auto" style="color: white;">
                        <h3 class="m-subheader__title m-subheader__title--separator" style="color: white;">
                            @(en != null ? "Details External Documents" : "Detail Surat Keluar Lainnya")
                        </h3>
                        <ul class="m-subheader__breadcrumbs m-nav m-nav--inline">
                            <li class="m-nav__item m-nav__item--home">
                                <a href="#" class="m-nav__link m-nav__link--icon">
                                    <i class="m-nav__link-icon la la-home" style="color: white;"></i>
                                </a>
                            </li>
                            <li class="m-nav__separator" style="color: white;">
                                -
                            </li>
                            <li class="m-nav__item">
                                <a href="" class="m-nav__link">
                                    <span class="m-nav__link-text" style="color: white;">
                                        @(en != null ? "Office" : "Office")
                                    </span>
                                </a>
                            </li>
                            <li class="m-nav__separator" style="color: white;">
                                -
                            </li>
                            <li class="m-nav__item">
                                <a href="" class="m-nav__link">
                                    <span class="m-nav__link-text" style="color: white;">
                                         @(en != null ? "Details External Documents" : "Detail Surat Keluar Lainnya")
                                    </span>
                                </a>
                            </li>
                    </div>
                </div>
            </div>
            <!-- END: Subheader -->
            <div class="m-content">
                <div class="kt-container  kt-grid__item kt-grid__item--fluid">
                    <div class="kt-grid kt-grid--desktop kt-grid--ver-desktop  kt-inbox" id="kt_inbox">
                        <div class="kt-grid__item kt-grid__item--fluid    kt-portlet    kt-inbox__view kt-inbox__view--shown-" id="kt_inbox_view" style="display:block">
                            <form method="post" id="formSurat" asp-action="@actionForm" asp-controller="Letter" enctype="multipart/form-data">
                                <div style="margin-left: 10px;">
                                    <br>
                                    <fieldset style="width:99%;background-color:#B7B7FF;">
                                        <div style="padding-left:10px">
                                            @foreach (var item in Model.disposition)
                                            {
                                                <fieldset>
                                                    <legend>
                                                        <b>&nbsp; @(en != null ? "Disposition" : "Disposisi")</b>
                                                    </legend>
                                                    <table>
                                                        <tbody>
                                                            <tr>
                                                                <td width="91">@(en != null ? "Disposition Date" : "Tgl Disposisi")</td>
                                                                <td>:</td>
                                                                <td>@Convert.ToDateTime(item.dispositionDate).ToString("dd MMM yyyy")</td>
                                                            </tr>
                                                            <tr>
                                                                <td width="91">@(en != null ? "From" : "Dari")</td>
                                                                <td>:</td>
                                                                <td>@item.fullnameDispositionMaker / @item.positionDispositionMaker</td>
                                                            </tr>
                                                            <tr>
                                                                <td width="91">@(en != null ? "To" : "Kepada")</td>
                                                                <td>:</td>
                                                                <td>@item.fullnameDispositionReceiver / @item.positionDispositionReceiver</td>
                                                            </tr>
                                                            <tr>
                                                                <td width="91">@(en != null ? "Note" : "Catatan")</td>
                                                                <td>:</td>
                                                                <td>@item.notes</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </fieldset>
                                            }
                                        </div>
                                    </fieldset>
                                    <br>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 col-sm-12" style="padding-top: 1%;padding-left: 2%;">
                                        <fieldset>
                                            <legend style="font-size: 10pt"><b>@(en != null ? "Header" : "Kepala Surat")</b></legend>

                                            <input type="hidden" class="form-control" id="saveType" name="saveType">
                                            <input type="hidden" class="form-control" id="letterTypeCode" name="letterTypeCode" value="@Model.letter.letterTypeCode">
                                            <input type="hidden" class="form-control" id="idresponsesurat" name="idresponsesurat" value="@Model.letter.idLetter">
                                            @if ((Model.letter.statusCode == 1 || Model.letter.statusCode == 5) && Model.letter.createdBy.ToString().ToUpper() == sessidUser)
                                            {
                                                <div class="form-group row">
                                                    <div class="col-lg-4">
                                                        <label>@(en != null ? "Document" : "Dokumen") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                        <select class="form-control" id="outboxType" name="outboxType" required>
                                                            <option value="">--@(en != null ? "Select Letter Document" : "Pilih Dokumen Surat")--</option>
                                                            @if (Model.letter.outboxType == 1)
                                                            {
                                                                <option value="1" selected="selected">Surat Keluar Direksi</option>
                                                                @if (sessidGroup == "S" || sessidUnit == "D52B6D38-EA42-ED11-958D-0050568AADBF" || sessidUnit == "DA2B6D38-EA42-ED11-958D-0050568AADBF")
                                                                {
                                                                    <option value="2">Surat Keluar Dewan Komisaris</option>
                                                                }
                                                                <option value="2">Surat Keluar Dewan Komisaris</option>
                                                                <option value="3">Surat Keluar Divisi</option>
                                                            }
                                                            else if (Model.letter.outboxType == 2)
                                                            {
                                                                <option value="1">Surat Keluar Direksi</option>
                                                                @if (sessidGroup == "S" || sessidUnit == "D52B6D38-EA42-ED11-958D-0050568AADBF" || sessidUnit == "DA2B6D38-EA42-ED11-958D-0050568AADBF")
                                                                {
                                                                    <option value="2" selected="selected">Surat Keluar Dewan Komisaris</option>
                                                                }
                                                                <option value="3">Surat Keluar Divisi</option>
                                                            }
                                                            else
                                                            {
                                                                <option value="1">Surat Keluar Direksi</option>
                                                                @if (sessidGroup == "S" || sessidUnit == "D52B6D38-EA42-ED11-958D-0050568AADBF" || sessidUnit == "DA2B6D38-EA42-ED11-958D-0050568AADBF")
                                                                {
                                                                    <option value="2">Surat Keluar Dewan Komisaris</option>
                                                                }
                                                                <option value="3" selected="selected">Surat Keluar Divisi</option>
                                                            }
                                                        </select>
                                                    </div>
                                                    <div class="col-lg-4">
                                                        <label>Nomor Surat:</label>
                                                        <input type="text" class="form-control" autocomplete="off" placeholder="No Letter" readonly="1" style="background-color:#e6e9ec !important">
                                                    </div>
                                                    <div class="col-lg-4">
                                                        <label>@(en != null ? "Date:" : "Tanggal:")</label>
                                                        <input type="date" class="form-control" autocomplete="off" placeholder="Tanggal" value="@dateLetter" id="letterDate" name="letterDate" max="@dateNow">
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <div class="col-md-12">
                                                        <label>@(en != null ? "Subject:" : "Perihal:") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                        <input type="text" class="form-control" autocomplete="off" id="about" name="about" value="@Model.letter.about" required>
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <div class="col-lg-4">
                                                        <label>@(en != null ? "Result" : "Hasil")  <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                        <select class="form-control" id="resultType" name="resultType" required>
                                                            <option value="">--@(en != null ? "Select Results" : "Pilih Hasil")--</option>
                                                            @if (Model.letter.resultType == 1)
                                                            {
                                                                <option value="1" selected="selected">Softcopy</option>
                                                                <option value="2">Hardcopy</option>
                                                            }
                                                            else
                                                            {
                                                                <option value="1">Softcopy</option>
                                                                <option value="2" selected="selected">Hardcopy</option>
                                                            }

                                                        </select>
                                                    </div>
                                                    <div class="col-lg-4">
                                                        <label>@(en != null ? "Signature" : "Tanda tangan") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                        <select class="form-control" id="signatureType" name="signatureType" required>
                                                            <option value="">--@(en != null ? "Select Type Signature" : "Pilih jenis tanda tangan")--</option>
                                                            @if (Model.letter.signatureType == 1)
                                                            {
                                                                <option value="1" selected="selected">Tanda Tangan</option>
                                                                <option value="2">Barcode</option>
                                                                <option value="3">Tanda Tangan & Barcode</option>
                                                            }
                                                            else if (Model.letter.signatureType == 2)
                                                            {
                                                                <option value="1">Tanda Tangan</option>
                                                                <option value="2" selected="selected">Barcode</option>
                                                                <option value="3">Tanda Tangan & Barcode</option>
                                                            }
                                                            else
                                                            {
                                                                <option value="1">Tanda Tangan</option>
                                                                <option value="2">Barcode</option>
                                                                <option value="3" selected="selected">Tanda Tangan & Barcode</option>
                                                            }

                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <div class="col-lg-4">
                                                        <label>@(en != null ? "Attachment:" : "Lampiran:")</label>
                                                        <input type="text" class="form-control" autocomplete="off" id="attachmentCount" value="@Model.letter.attachmentDesc" name="attachmentCount" readonly="readonly" style="background-color:#e6e9ec !important">
                                                    </div>
                                                    <div class="col-lg-4" style="display:none">
                                                        <label>@(en != null ? "Priority" : "Prioritas")</label>
                                                        <input type="text" class="form-control" autocomplete="off" placeholder="Prioritas" name="priority" id="priority" value="@Model.letter.priority">
                                                    </div>
                                                </div>
                                            }
                                            else
                                            {
                                                <div class="form-group row" style="font-size:8pt;margin-bottom: 0%;">
                                                    <label for="inputEmail3" style="font-size:8pt !important;" class="col-sm-3">&nbsp;@(en != null ? "Type/Number/Date of Mail:" : "Jenis/Nomor/Tgl Surat:") </label>
                                                    <div class="col-6">
                                                        <b>@Model.letter.outboxTypeCodeValue / @Model.letter.letterNumber / @dateLetter</b>
                                                        <input type="hidden" class="form-control" autocomplete="off" id="idresponsesurat" name="idresponsesurat" value="@Model.letter.idLetter">
                                                    </div>
                                                </div>
                                                <div class="form-group row" style="font-size:8pt;margin-bottom: 0%;">
                                                    <label for="inputEmail3" style="font-size:8pt !important;" class="col-sm-3">&nbsp;@(en != null ? "Subject:" : "Perihal:") </label>
                                                    <div class="col-6">
                                                        <b>@Model.letter.about</b>
                                                    </div>
                                                </div>
                                                <div class="form-group row" style="font-size:8pt;margin-bottom: 0%;">
                                                    <label for="inputEmail3" style="font-size:8pt !important;" class="col-sm-3">&nbsp;@(en != null ? "Result" : "Hasil") : </label>
                                                    <div class="col-6">
                                                        <b>@Model.letter.resultTypeCodeValue</b>
                                                    </div>
                                                </div>
                                                <div class="form-group row" style="font-size:8pt;margin-bottom: 0%;">
                                                    <label for="inputEmail3" style="font-size:8pt !important;" class="col-sm-3">&nbsp;@(en != null ? "Signature" : "Tanda tangan") : </label>
                                                    <div class="col-6">
                                                        <b>@Model.letter.signatureTypeCodeValue</b>
                                                    </div>
                                                </div>
                                                <div class="form-group row" style="font-size:8pt;margin-bottom: 0%;">
                                                    <label for="inputEmail3" style="font-size:8pt !important;" class="col-sm-3">&nbsp;@(en != null ? "Attachment:" : "Lampiran:") </label>
                                                    <div class="col-6">
                                                        <b>@Model.letter.attachmentDesc</b>
                                                    </div>
                                                    <div class="col-3 row" style="display:none">
                                                        <label for="inputEmail3" style="font-size:8pt !important;" class="col-sm-8">&nbsp;@(en != null ? "Priority:" : "Prioritas:") </label>
                                                        <b>@Model.letter.priority</b>
                                                    </div>
                                                </div>
                                            }
                                            <fieldset>
                                                <legend style="font-size: 10pt"><b>@(en != null ? "Sender" : "Pengirim")</b></legend>
                                                @if ((Model.letter.statusCode == 1 || Model.letter.statusCode == 5) && Model.letter.createdBy.ToString().ToUpper() == sessidUser)
                                                {
                                                    foreach (var item in Model.sender)
                                                    {
                                                        <div class="form-group row" style="margin-bottom: 0px !important;">
                                                            <div class="col-md-12">
                                                                <label>@(en != null ? "Name" : "Nama") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                                <input type="text" class="form-control" value="@item.fullname" id="bossName" name="bossName" placeholder="" autocomplete="off" required="" onkeyup="load_data_pemeriksa(this.value,1000)">
                                                                <span id="search_result_sender"></span>
                                                                <input type="hidden" class="form-control" id="bossPositionId" name="bossPositionId" value="@item.idPositionSender">
                                                                <input type="hidden" class="form-control" id="bossUserId" name="bossUserId" value="@item.idUserSender">
                                                                <input type="hidden" class="form-control" id="bossUnitId" name="bossUnitId" value="@item.idUnitSender">
                                                                <input type="hidden" class="form-control" id="bossLevelId" value="@item.idLevelSender" name="bossLevelId">
                                                            </div>
                                                        </div>
                                                        <div class="form-group row" style="margin-bottom: 0px !important;">
                                                            <div class="col-md-3">
                                                                <label>NPP <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                                <input type="text" class="form-control" autocomplete="off" value="@item.nip" id="nipBoss" name="nipBoss" required readonly="readonly" style="background-color:#e6e9ec !important">
                                                            </div>
                                                            <div class="col-md-9">
                                                                <label>@(en != null ? "Position" : "Jabatan") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                                <input type="text" class="form-control" autocomplete="off" value="@item.positionName" id="bossPositionName" name="bossPositionName" readonly="readonly" style="background-color:#e6e9ec !important">
                                                            </div>
                                                        </div>
                                                    }

                                                }
                                                else
                                                {
                                                    foreach (var item in Model.sender)
                                                    {
                                                        <div class="form-group row" style="margin-bottom: 0px !important;">
                                                            <div class="col-md-12">
                                                                <label>@(en != null ? "Name" : "Nama") : </label>
                                                                <b>@item.fullname</b>
                                                                <span id="search_result_sender"></span>
                                                                <input type="hidden" class="form-control" id="bossPositionId" name="bossPositionId" value="@item.idPositionSender">
                                                                <input type="hidden" class="form-control" id="bossUserId" name="bossUserId" value="@item.idUserSender">
                                                                <input type="hidden" class="form-control" id="bossUnitId" name="bossUnitId" value="@item.idUnitSender">
                                                                <input type="hidden" class="form-control" id="bossLevelId" value="@item.idLevelSender" name="bossLevelId">
                                                            </div>
                                                        </div>
                                                        <div class="form-group row" style="margin-bottom: 0px !important;">
                                                            <div class="col-md-3">
                                                                <label>NPP : </label>
                                                                <b>@item.nip</b>
                                                            </div>
                                                            <div class="col-md-9">
                                                                <label>@(en != null ? "Position" : "Jabatan") : </label>
                                                                <b>@item.positionName</b>
                                                            </div>
                                                        </div>
                                                    }
                                                }
                                            </fieldset>
                                        </fieldset>
                                    </div>
                                    <div class="col-md-6 col-sm-12" style="padding-top: 1%;padding-left: 2%;">
                                        <fieldset>
                                            <legend style="font-size: 10pt"><b>@(en != null ? "Receiver" : "Penerima")</b></legend>
                                            @if ((Model.letter.statusCode == 1 || Model.letter.statusCode == 5) && Model.letter.createdBy.ToString().ToUpper() == sessidUser)
                                            {
                                                @if (Model.outgoingRecipient.Count == 0)
                                                {
                                                    <div class="form-group row" style="margin-bottom: 0px !important;">
                                                        <div class="col-8 col-md-6 col-sm-10">
                                                            <label>@(en != null ? "Name" : "Nama") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                            <input type="text" class="form-control" id="senderName" autocomplete="off" name="senderName" required>
                                                        </div>
                                                        <div class="col-4 col-md-6 col-sm-2">
                                                            <label>&nbsp;</label>
                                                            <input type="button" value="+" id="btnAddReceiver" onclick="AddTextBoxReceiver()" class="btn btn-success" style="display:block">
                                                        </div>
                                                    </div>
                                                    <div id="TextBoxContainerReceiver">
                                                        <!--Textboxes will be added here -->
                                                    </div>
                                                    <div class="form-group row" style="margin-bottom: 0px !important;">
                                                        <div class="col-md-6">
                                                            <label>@(en != null ? "Phone Nunber" : "No HP")<span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                            <input type="text" class="form-control" id="senderPhoneNumber" autocomplete="off" name="senderPhoneNumber" required>
                                                        </div>
                                                    </div>
                                                    <div class="form-group row" style="margin-bottom: 0px !important;">
                                                        <div class="col-md-6">
                                                            <label>@(en != null ? "Commpany Name" : "Nama Perusahaan")<span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                            <input type="text" class="form-control" id="senderCompanyName" autocomplete="off" name="senderCompanyName" required>
                                                        </div>
                                                    </div>
                                                    <div class="form-group row" style="margin-bottom: 0px !important;">
                                                        <div class="col-md-11">
                                                            <label>@(en != null ? "Address" : "Alamat") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                            <textarea class="form-control" id="senderAddress" name="senderAddress" required></textarea>
                                                        </div>
                                                    </div>
                                                }
                                                else
                                                {
                                                    foreach (var item in Model.outgoingRecipient)
                                                    {
                                                        var idDivReceiver = "divReceiver" + orderkepada;
                                                        <div class="form-group row" id="@idDivReceiver" style="margin-bottom: 0px !important;">
                                                            <div class="col-8 col-md-6 col-sm-10">
                                                                <label>@(en != null ? "Name" : "Nama") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                                <input type="text" class="form-control" autocomplete="off" value="@item.recipientName" id="senderName" name="senderName" required>
                                                            </div>
                                                            <div class="col-4 col-md-6 col-sm-2">
                                                                <label>&nbsp;</label>
                                                                @if (orderkepada == 0)
                                                                {
                                                                    <input type="button" value="+" id="btnAddReceiver" onclick="AddTextBoxReceiver()" class="btn btn-success" style="display:block">
                                                                }
                                                                else
                                                                {
                                                                    <input type="button" value="-" id="btnRemoveReceiver" onclick="RemoveTextBoxReceiver(@orderkepada)" class="btn btn-warning" style="display:block">
                                                                }
                                                            </div>
                                                        </div>
                                                        orderkepada++;
                                                    }
                                                    <div id="TextBoxContainerReceiver">
                                                        <!--Textboxes will be added here -->
                                                    </div>
                                                    <div class="form-group row" style="margin-bottom: 0px !important;">
                                                        <div class="col-md-6">
                                                            <label>@(en != null ? "Phone Nunber" : "No HP")<span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                            <input type="text" class="form-control" id="senderPhoneNumber" autocomplete="off" name="senderPhoneNumber" value="@Model.outgoingRecipient[0].recipientPhoneNumber" required>
                                                        </div>
                                                    </div>
                                                    <div class="form-group row" style="margin-bottom: 0px !important;">
                                                        <div class="col-md-6">
                                                            <label>@(en != null ? "Commpany Name" : "Nama Perusahaan")<span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                            <input type="text" class="form-control" autocomplete="off" value="@Model.outgoingRecipient[0].recipientCompany" id="senderCompanyName" name="senderCompanyName" required>
                                                        </div>
                                                    </div>
                                                    <div class="form-group row" style="margin-bottom: 0px !important;">
                                                        <div class="col-md-11">
                                                            <label>@(en != null ? "Address" : "Alamat") <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                                            <textarea class="form-control" value="@Model.outgoingRecipient[0].recipientAddress" id="senderAddress" name="senderAddress" required>@Model.outgoingRecipient[0].recipientAddress</textarea>
                                                        </div>
                                                    </div>
                                                }
                                            }
                                            else
                                            {
                                                <div class="form-group row" style="margin-bottom: 0px !important;">
                                                    <div class="col-md-6">
                                                        <label>@(en != null ? "Name" : "Nama") : </label>
                                                        @if(Model.outgoingRecipient.Count() > 1)
                                                        {
                                                            <br />
                                                            <ol>
                                                            @foreach (var item in Model.outgoingRecipient)
                                                            {
                                                                <li><b>@item.recipientName</b></li>
                                                            }
                                                        </ol>
                                                        }else{
                                                            @foreach (var item in Model.outgoingRecipient)
                                                            {
                                                                <b>@item.recipientName</b>
                                                            }
                                                        }
                                                        
                                                    </div>
                                                </div>
                                                <div class="form-group row" style="margin-bottom: 0px !important;">
                                                    <div class="col-md-11">
                                                        <label>@(en != null ? "Phone Nunber" : "No HP") : </label> <b>@Model.outgoingRecipient[0].recipientPhoneNumber</b>
                                                    </div>
                                                </div>
                                                <div class="form-group row" style="margin-bottom: 0px !important;">
                                                    <div class="col-md-11">
                                                        <label>@(en != null ? "Commpany Name" : "Nama Perusahaan") : </label> <b>@Model.outgoingRecipient[0].recipientCompany</b>
                                                    </div>
                                                </div>
                                                <div class="form-group row" style="margin-bottom: 0px !important;">
                                                    <div class="col-md-11">
                                                        <label>@(en != null ? "Address" : "Alamat") : </label><br />
                                                        <b>@Model.outgoingRecipient[0].recipientAddress</b>
                                                    </div>
                                                </div>
                                            }

                                        </fieldset>
                                        <fieldset>
                                            <legend style="font-size: 10pt"><b>@(en != null ? "Approval" : "Persetujuan")</b></legend>
                                            @if ((Model.letter.statusCode == 1 || Model.letter.statusCode == 5) && Model.letter.createdBy.ToString().ToUpper() == sessidUser)
                                            {
                                                @if (Model.Approval.Count == 0)
                                                {
                                                    <div class="form-group row" style="margin-bottom: 0px;margin-top: 0px;">
                                                        <div class="col-8 col-md-6 col-sm-10">
                                                            <label>&nbsp;</label>
                                                            <input type="text" autocomplete="off" class="form-control" placeholder="" id="checkerApprover_0" name="checkerApprover_0" required="" onkeyup="load_data_Approver(this.value,0)">
                                                            <span id="search_resultApprover_0"></span>
                                                            <input type="hidden" class="form-control" id="idUserApprover_0" name="idUserApprover">
                                                            <input type="hidden" class="form-control" id="idPositionApprover_0" name="idPositionApprover">
                                                            <input type="hidden" class="form-control" id="idLevelApprover_0" name="idLevelApprover">
                                                            <input type="hidden" class="form-control" id="idUnitApprover_0" name="idUnitApprover">
                                                                </div>
                                                        <div class="col-4 col-md-6 col-sm-2">
                                                            <label>&nbsp;</label>
                                                           <input type="button" value="+" id="btnAddApprover" onclick="AddTextBoxCheckerApprover()" class="btn btn-success" style="display:block">
                                                        </div>
                                                    </div>
                                                }
                                                else
                                                {
                                                    foreach (var item in Model.Approval)
                                                    {
                                                        var idDivChecker = "divDispo" + orderApprover;
                                                        <div class="form-group row" id="@idDivChecker" style="margin-bottom: 0px;margin-top: 0px;">
                                                            <div class="col-8 col-md-6 col-sm-10">
                                                                <label>&nbsp;</label>
                                                                <input type="text" autocomplete="off" class="form-control" placeholder="Persetujuan" value="@item.fullname - @item.positionName" id="checker_@orderApprover" name="checker_0" required="" onkeyup="load_data_Approver(this.value,@orderApprover)">
                                                                <span id="search_result_@orderApprover"></span>
                                                                <input type="hidden" class="form-control" id="idUserChecker_@orderApprover" value="@item.idUserChecker" name="idUserApprover">
                                                                <input type="hidden" class="form-control" id="idPositionChecker_@orderApprover" value="@item.idPositionChecker" name="idPositionApprover">
                                                                <input type="hidden" class="form-control" id="idLevelChecker_@orderApprover" value="@item.idLevelChecker" name="idLevelApprover">
                                                                <input type="hidden" class="form-control" id="idUnitChecker_@orderApprover" value="@item.idUnitChecker" name="idUnitApprover">
                                                            </div>
                                                            <div class="col-4 col-md-6 col-sm-2">
                                                                <label>&nbsp;</label>
                                                                @if (orderApprover == 0)
                                                                {
                                                                    <input type="button" value="+" id="btnAddApprover" onclick="AddTextBoxCheckerApprover()" class="btn btn-success" style="display:block">
                                                                }
                                                                else
                                                                {
                                                                    <input type="button" value="-" id="btnRemoveApprover" onclick="RemoveTextBoxApprover(@orderApprover)" class="btn btn-warning" style="display:block">
                                                                }

                                                            </div>
                                                        </div>
                                                        orderApprover++;
                                                    }
                                                }
                                                <div id="TextBoxContainerCheckerApprover">
                                                    <!--Textboxes will be added here -->
                                                </div>
                                            }
                                            else
                                            {
                                                <ol>
                                                    @foreach (var item in Model.Approval)
                                                    {
                                                        <li>@item.fullname - @item.positionName</li>
                                                    }
                                                </ol>
                                            }


                                        </fieldset>
                                        <fieldset>
                                            <legend style="font-size: 10pt"><b>@(en != null ? "Checker" : "Pemeriksa")</b></legend>
                                            @if ((Model.letter.statusCode == 1 || Model.letter.statusCode == 5) && Model.letter.createdBy.ToString().ToUpper() == sessidUser)
                                            {
                                                @if (Model.checker.Count == 0)
                                                {
                                                    <div class="form-group row" style="margin-bottom: 0px;margin-top: 0px;">
                                                        <div class="col-8 col-md-6 col-sm-10">
                                                            <label>&nbsp;</label>
                                                            <input type="text" class="form-control" autocomplete="off" placeholder="Pemeriksa" id="checker_0" name="checker_0" required="" onkeyup="load_data_pemeriksa(this.value,0)">
                                                            <span id="search_result_0"></span>
                                                            <input type="hidden" class="form-control" id="idUserChecker_0" name="idUserChecker">
                                                            <input type="hidden" class="form-control" id="idPositionChecker_0" name="idPositionChecker">
                                                            <input type="hidden" class="form-control" id="idLevelChecker_0" name="idLevelChecker">
                                                            <input type="hidden" class="form-control" id="idUnitChecker_0" name="idUnitChecker">
                                                        </div>
                                                        <div class="col-4 col-md-6 col-sm-2">
                                                            <label>&nbsp;</label>
                                                            <input type="button" value="+" id="btnAddChecker" onclick="AddTextBoxChecker()" class="btn btn-success" style="display:block">
                                                        </div>
                                                    </div>
                                                }
                                                else
                                                {
                                                    foreach (var item in Model.checker)
                                                    {
                                                        var idDivChecker = "divDispo" + orderpemeriksa;
                                                        <div class="form-group row" id="@idDivChecker" style="margin-bottom: 0px;margin-top: 0px;">
                                                            <div class="col-8 col-md-6 col-sm-10">
                                                                <label>&nbsp;</label>
                                                                <input type="text" class="form-control" autocomplete="off" placeholder="Pemeriksa" value="@item.fullname - @item.positionName" id="checker_@orderpemeriksa" name="checker_0" required="" onkeyup="load_data_pemeriksa(this.value,@orderpemeriksa)">
                                                                <span id="search_result_@orderpemeriksa"></span>
                                                                <input type="hidden" class="form-control" id="idUserChecker_@orderpemeriksa" value="@item.idUserChecker" name="idUserChecker">
                                                                <input type="hidden" class="form-control" id="idPositionChecker_@orderpemeriksa" value="@item.idPositionChecker" name="idPositionChecker">
                                                                <input type="hidden" class="form-control" id="idLevelChecker_@orderpemeriksa" value="@item.idLevelChecker" name="idLevelChecker">
                                                                <input type="hidden" class="form-control" id="idUnitChecker_@orderpemeriksa" value="@item.idUnitChecker" name="idUnitChecker">
                                                            </div>
                                                            <div class="col-4 col-md-6 col-sm-2">
                                                                <label>&nbsp;</label>
                                                                @if (orderpemeriksa == 0)
                                                                {
                                                                    <input type="button" value="+" id="btnAddChecker" onclick="AddTextBoxChecker()" class="btn btn-success" style="display:block">
                                                                }
                                                                else
                                                                {
                                                                    <input type="button" value="-" id="btnRemoveChecker" onclick="RemoveTextBoxChecker(@orderpemeriksa)" class="btn btn-warning" style="display:block">
                                                                }

                                                            </div>
                                                        </div>
                                                        orderpemeriksa++;
                                                    }
                                                }
                                                <div id="TextBoxContainerChecker">
                                                    <!--Textboxes will be added here -->
                                                </div>
                                            }
                                            else
                                            {
                                                <ol>
                                                    @foreach (var item in Model.checker)
                                                    {
                                                        <li>@item.fullname - @item.positionName</li>
                                                    }
                                                </ol>
                                            }


                                        </fieldset>
                                        <fieldset>
                                            <legend style="font-size: 10pt"><b>@(en != null ? "Attachment" : "Lampiran")</b></legend>
                                            @if (Model.letter.statusCode == 1)
                                            {
                                                <ol>
                                                    @foreach (var item in Model.attachment)
                                                    {
                                                        <li>
                                                            <a href="@Url.Action("DownloadAttachment","Letter")?filename=@item.filename" target="_blank">@item.filename</a>
                                                            <a style="cursor:pointer;color: white;padding:1px;" class="btn btn-danger" onclick="deletefile('@item.idAttachment')"> Delete </a>
                                                        </li>
                                                    }

                                                </ol>
                                            }
                                            else
                                            {
                                                <ol>
                                                    @foreach (var item in Model.attachment)
                                                    {
                                                        <li><a href="@Url.Action("DownloadAttachment","Letter")?filename=@item.filename" target="_blank">@item.filename</a></li>
                                                    }
                                                </ol>
                                            }
                                        </fieldset>
                                    </div>
                                </div>
                                @if ((Model.letter.statusCode == 1 || Model.letter.statusCode == 5) && Model.letter.createdBy.ToString().ToUpper() == sessidUser)
                                {
                                    <div class="kt-inbox__primary" id="alltemplate" align="Center" style="display: marker;overflow-x: auto;white-space: nowrap;max-width: 100%;margin-left: 1%;margin-right: 1%;">
                                        <br>
                                        @foreach (var item in ViewBag.TemplateData)
                                        {
                                            <div class="btn-group">
                                                <button type="button" class="btn btn-success btn-bold" data-toggle="modal" data-target="#template_@noTemplate">
                                                    <i class="flaticon2-checking">&nbsp;@item.templateName</i>
                                                </button>
                                            </div>
                                            <div class="modal fade" id="template_@noTemplate" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel2" aria-hidden="true">
                                                <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="exampleModalLabel2">@item.templateName</h5>
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                        </div>
                                                        <div class="modal-body" style="text-align: center;">
                                                            <textarea class="data_template">@HttpUtility.HtmlDecode(item.templateContent)</textarea>
                                                        </div>
                                                        <div class="modal-footer test">
                                                            <div style='float: left;'>
                                                                <button type="button" onclick="ganti_template('@item.idContentTemplate',@noTemplate)" class="btn btn-success flaticon-list">&nbsp;Pilih</button>
                                                            </div>
                                                            <div style='float: right;'>
                                                                <button type="button" class="btn btn-danger flaticon-close" data-dismiss="modal">&nbsp;Close</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            noTemplate++;
                                        }

                                    </div>
                                }
                                <div class="col-md-12" style="padding-top: 2%;">
                                    <div class="tinymce">
                                        <textarea id="isiSurat" name="isiSurat">
                                            @Model.letterContent.letterContent
                                        </textarea>
                                    </div>
                                </div>
                                @if ((Model.letter.statusCode == 1 || Model.letter.statusCode == 5) && Model.letter.createdBy.ToString().ToUpper() == sessidUser)
                                {
                                    <div class="col-md-12">
                                        <div class="form-group row" style="width: 100%">
                                            <label class="col-lg-3 col-form-label">@(en != null ? "Upload Attachment Files:" : "Upload File Lampiran:")</label>
                                            <div class="col-lg-12">
                                                <div class="kt-uppy dropzone" id="dropss" width="100%" style="height: 100px;">
                                                </div>
                                                <span class="form-text text-muted">File type: JPG, PNG, DOC, DOCX, XLS, XLSX, PDF(Maksimal 15MB)</span>
                                            </div>
                                        </div>
                                    </div>
                                }
                                @if (Model.letter.statusCode == 1 || Model.letter.statusCode == 5)
                                {
                                    <div class="col-md-3">
                                        <div class="form-group row" style="width: 100%">
                                            <div class="btn-group col-sm-2">
                                                <button type="button" class="btn btn-warning btn-bold" id="btnPreview">
                                                    <i class="flaticon2-checking">&nbsp;Preview</i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                }
                                else
                                {
                                    <div class="col-md-3">
                                        <div class="form-group row" style="width: 100%">
                                            <div class="btn-group col-sm-2">
                                                <button type="button" class="btn btn-warning btn-bold" onclick="printSurat('@Model.letter.idLetter')">
                                                    <i class="flaticon2-checking">&nbsp;Preview</i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                }

                                @if (((Model.letter.statusCode == 1 || Model.letter.statusCode == 5) && Model.letter.createdBy.ToString().ToUpper() == sessidUser) || (Model.letter.statusCode == 2 && (currentChecker != null || currentSekreChecker != null || currentApprover !=null || currentCheckerPengirim != null)))
                                {
                                    <div class="col-md-6">
                                        <div class="form-group row" style="width: 100%">
                                            <label class="col-lg-3 col-form-label">@(en != null ? "Komentar:" : "Comment:")  <span aria-hidden="true" class="required" style="color: red;">*</span></label>
                                            <div class="col-lg-12">
                                                <textarea class="form-control" id="comment" name="comment" cols="45" rows="3" required></textarea>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="kt-inbox__primary" style="padding-bottom: 5%;">
                                        <div class="col-6">
                                            <h3>@(en != null ? "Log History" : "Log History")</h3>
                                            <div style="border:solid 1px lightgray;border-radius:10px;width:100%;max-height:142px;min-height:142px;overflow-y:scroll">
                                                <ul>
                                                    @foreach (var dtLog in Model.log)
                                                    {
                                                        var word = Convert.ToDateTime(dtLog.createdOn).ToString("dd-MM-yyyy HH:mm:ss") + " - " + dtLog.description;
                                                        <li>@word</li>
                                                    }
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                }
                                else
                                {
                                    <div class="kt-inbox__primary" style="padding-bottom: 5%;">
                                        <div class="col-6">
                                            <h3>Log History</h3>
                                            <div style="border:solid 1px lightgray;border-radius:10px;width:100%;max-height:142px;min-height:142px;overflow-y:scroll">
                                                <ul>
                                                    @foreach (var dtLog in Model.log)
                                                    {
                                                        var word = Convert.ToDateTime(dtLog.createdOn).ToString("dd-MM-yyyy HH:mm:ss") + " - " + dtLog.description;
                                                        <li>@word</li>
                                                    }
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                }
                                @if ((Model.letter.statusCode == 1 || Model.letter.statusCode == 5) && Model.letter.createdBy.ToString().ToUpper() == sessidUser)
                                {
                                    <div class="kt-inbox__foot" style="padding-bottom: 2%;">
                                        <div class="kt-inbox__primary">
                                            <div class="btn-group col-sm-2">
                                                <button type="button" class="btn btn-success btn-bold" onclick="saveSurat(1)">
                                                    <i class="flaticon-paper-plane-1">&nbsp;@(en != null ? "Save" : "Simpan")</i>
                                                </button>
                                            </div>
                                            <div class="btn-group col-sm-2">
                                                <button type="button" class="btn btn-warning btn-bold" style="color: white;" onclick="saveSurat(2)">
                                                    <i class="flaticon-paper-plane-1">&nbsp;@(en != null ? "Send" : "Kirim")</i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                }
                                else if (Model.letter.statusCode == 2 && currentChecker != null)
                                {
                                    <div class="kt-inbox__foot" style="padding-bottom: 2%;">
                                        <div class="kt-inbox__primary">
                                            <div class="btn-group col-sm-2">
                                                <button type="button" class="btn btn-success btn-bold" onclick="aksiAtasan(5)">
                                                    <i class="flaticon-paper-plane-1">&nbsp;@(en != null ? "Reject" : "Tolak")</i>
                                                </button>
                                            </div>
                                            <div class="btn-group col-sm-2">
                                                <button type="button" class="btn btn-warning btn-bold" style="color: white;" onclick="aksiAtasan(4)">
                                                    <i class="flaticon-paper-plane-1">&nbsp;@(en != null ? "Approve" : "Setuju")</i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                }
                                 else if (Model.letter.statusCode == 2 && currentApprover != null)
                                {
                                    <div class="kt-inbox__foot" style="padding-bottom: 2%;">
                                        <div class="kt-inbox__primary">
                                            <div class="btn-group col-sm-2">
                                                <button type="button" class="btn btn-success btn-bold" onclick="aksiAtasan(5)">
                                                    <i class="flaticon-paper-plane-1">&nbsp;@(en != null ? "Reject" : "Tolak")</i>
                                                </button>
                                            </div>
                                            <div class="btn-group col-sm-2">
                                                <button type="button" class="btn btn-warning btn-bold" style="color: white;" onclick="aksiAtasan(4)">
                                                    <i class="flaticon-paper-plane-1">&nbsp;@(en != null ? "Approve" : "Setuju")</i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                }
                                 else if (Model.letter.statusCode == 2 && currentCheckerPengirim != null)
                                {
                                    <div class="kt-inbox__foot" style="padding-bottom: 2%;">
                                        <div class="kt-inbox__primary">
                                            <div class="btn-group col-sm-2">
                                                <button type="button" class="btn btn-success btn-bold" onclick="aksiAtasan(5)">
                                                    <i class="flaticon-paper-plane-1">&nbsp;@(en != null ? "Reject" : "Tolak")</i>
                                                </button>
                                            </div>
                                            <div class="btn-group col-sm-2">
                                                <button type="button" class="btn btn-warning btn-bold" style="color: white;" onclick="aksiAtasan(4)">
                                                    <i class="flaticon-paper-plane-1">&nbsp;@(en != null ? "Approve" : "Setuju")</i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                }
                                else if (Model.letter.statusCode == 2 && sessidGroup == "S" && currentSekreChecker != null)
                                {
                                    <div class="kt-inbox__foot" style="padding-bottom: 2%;">
                                        <div class="kt-inbox__primary">
                                            <div class="btn-group col-sm-2">
                                                <button type="button" class="btn btn-success btn-bold" onclick="aksiAtasan(5)">
                                                    <i class="flaticon-paper-plane-1">&nbsp;@(en != null ? "Reject" : "Tolak")</i>
                                                </button>
                                            </div>
                                            <div class="btn-group col-sm-2">
                                                <button type="button" class="btn btn-warning btn-bold" style="color: white;" onclick="aksiAtasan(4)">
                                                    <i class="flaticon-paper-plane-1">&nbsp;@(en != null ? "Approve" : "Setuju")</i>
                                                </button>
                                            </div>
                                            <div class="btn-group col-sm-2">
                                                <button type="button" class="btn btn-primary btn-bold" style="color: white;" onclick="aksiNotif('@Model.letter.idLetter')">
                                                    <i class="flaticon-bell-1">&nbsp;@(en != null ? "Notification" : "Notifikasi")</i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                }

                            </form>
                            @if (Model.letter.statusCode == 4)
                            {
                                <div class="kt-inbox__foot" style="padding-bottom: 2%;">
                                    <div class="kt-inbox__primary">
                                        <div class="btn-group col-sm-2" style="display:none;">
                                            <button type="button" class="btn btn-success btn-bold" onclick="disposisi()" style="padding-bottom: 3%;padding-top: 3%;">
                                                <i class="flaticon2-mail-1" style="font-size: 14pt;padding-top: 3%;"></i><label style="margin-bottom: 0;font-size: 1.2rem;">&nbsp;Disposisi</label>
                                            </button>
                                        </div>

                                        <div id="disposisi" class="form-group" style="display:none;background-color:#afd1ea;margin-left: 0.8%;margin-right: 0.8%;margin-top: 1%;padding-bottom: 1%;padding-top: 1%;">
                                            <form method="post" asp-action="PostLetterDisposition" asp-controller="Letter">
                                                <div id="divDispo" class="form-group row" style="margin-left:0.8%;margin-right:0.8%;">
                                                    <input type="hidden" class="form-control" id="idLetter" name="idLetter" value="@Model.letter.idLetter">
                                                    <div class="col-md-3">
                                                        <label>@(en != null ? "Forwarded To" : "Diteruskan Kepada")</label>
                                                        <input type="text" class="form-control" autocomplete="off" id="idUserText_0" name="idUserText_0" placeholder="autocomplete" required="" onkeyup="load_data(this.value,0)">
                                                        <span id="search_result_0"></span>
                                                        <input type="hidden" class="form-control" id="idUser_0" name="idUser">
                                                        <input type="hidden" class="form-control" id="idPosition_0" name="idPosition">
                                                    </div>
                                                    <div class="col-md-3">
                                                        <label>@(en != null ? "Notes" : "Catatan")</label>
                                                        <textarea name="notes" id="notes_0" cols="40" class="form-control" style="resize: none;"></textarea>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <label>&nbsp;</label>
                                                        <input type="button" value="+" id="btnAddDisposisi" onclick="AddTextBoxDisposisi()" class="btn btn-success" style="display:block">
                                                    </div>
                                                </div>
                                                <div class="form-group" id="divDisposisi">
                                                </div>
                                                <div class="form-group">
                                                    <div class="btn-group col-sm-2" style="">
                                                        <button type="button" class="btn btn-success btn-bold" style="padding-bottom: 3%;padding-top: 3%;" id="submitDisposisi">
                                                            <i class="flaticon2-mail-1" style="font-size: 14pt;padding-top: 3%;"></i><label style="margin-bottom: 0;font-size: 1.2rem;">&nbsp;@(en != null ? "Process" : "Proses")</label>
                                                        </button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/assets/tinymcepack/tinymce.js?v=7.3.0" type="text/javascript"></script>
<link href="~/assets/demo/demo2/new_theme/css/dropzone.css" rel="stylesheet" type="text/css" />
<script src="~/assets/demo/demo2/new_theme/js/dropzone.js" type="text/javascript"></script>
<script type="text/javascript">
    var orderKepada = 0;
    var orderTembusan = 0;
    var orderDisposisi = 0;
    var orderPemeriksa = 0;
    var orderApprover = 0;
    $(document).ready(function () {
        var ordersKepada = @orderkepada+1;
        var ordersTembusan = @ordertembusan+1;
        var ordersDisposisi = @orderdisposisi+1;
        var ordersPemeriksa = @orderpemeriksa+1;
        var ordersApprover = @orderApprover+1;
        orderKepada = ordersKepada;
        orderTembusan = ordersTembusan;
        orderDisposisi = ordersDisposisi;
        orderPemeriksa = ordersPemeriksa;
        orderApprover = ordersApprover;

    });

    function AddTextBoxChecker() {
        var html = "<div id='divDispo" + orderPemeriksa + "' class='form-group row' style='margin-bottom: 0px;margin-top: 0px;'> <div class='col-8 col-md-6 col-sm-10'> <label>&nbsp;</label> <input type='text' class='form-control' id='checker_" + orderPemeriksa + "' name='checker_" + orderPemeriksa + "' placeholder='' autocomplete='off' required='' onkeyup='load_data_pemeriksa(this.value," + orderPemeriksa + ")'><span id='search_result_" + orderPemeriksa + "'></span> <input type='hidden' class='form-control idUserChecker' id='idUserChecker_" + orderPemeriksa + "' name='idUserChecker'> <input type='hidden' class='form-control idPositionChecker' id='idPositionChecker_" + orderPemeriksa + "' name='idPositionChecker'><input type='hidden' class='form-control idPositionChecker' id='idLevelChecker_" + orderPemeriksa + "' name='idLevelChecker'><input type='hidden' class='form-control' id='idUnitChecker_" + orderPemeriksa + "' name='idUnitChecker'> </div>  <div class='col-4 col-md-6 col-sm-2'> <label>&nbsp;</label> <input type='button' value='-' id='btnRemoveChecker' onclick='RemoveTextBoxChecker(" + orderPemeriksa + ")' class='btn btn-warning' style='display:block'> </div> </div>";
        $('#TextBoxContainerChecker').append(html);

        orderPemeriksa++;
    }
    function AddTextBoxReceiver() {
        var html = "<div id='divReceiver" + orderKepada + "' class='form-group row' style='margin-bottom: 0px;margin-top: 0px;'> <div class='col-8 col-md-6 col-sm-10'> <label>&nbsp;</label> <input type='text' class='form-control' id='senderName' name='senderName' placeholder='' autocomplete='off' required=''> </div>  <div class='col-4 col-md-6 col-sm-2'> <label>&nbsp;</label> <input type='button' value='-' id='btnRemoveReceiver' onclick='RemoveTextBoxReceiver(" + orderKepada + ")' class='btn btn-warning' style='display:block'> </div> </div>";
        $('#TextBoxContainerReceiver').append(html);
        orderKepada++;
    }
    function RemoveTextBoxChecker(idDiv) {
        $("#divDispo" + idDiv).remove();
    }

    function AddTextBoxDisposisi() {
        var html = "<div id='divDispo" + orderDisposisi + "' class='form-group row' style='margin-left:0.8%;margin-right:0.8%;'> <div class='col-md-3'> <label>Diteruskan Kepada</label> <input type='text' class='form-control' id='idUserText_" + orderDisposisi + "' name='idUserText_" + orderDisposisi + "' placeholder='' autocomplete='off' required='' onkeyup='load_data(this.value," + orderDisposisi + ")'><span id='search_result_" + orderDisposisi + "'></span> <input type='hidden' class='form-control idUserDispo' id='idUser_" + orderDisposisi + "' name='idUser'> <input type='hidden' class='form-control idPositionDispo' id='idPosition_" + orderDisposisi + "' name='idPosition'> </div> <div class='col-md-3'> <label>Catatan</label> <textarea name='notes' id='notes_0' cols='40' class='form-control' style='resize: none;'></textarea> </div> <div class='col-md-3'> <label>&nbsp;</label> <input type='button' value='-' id='btnRemoveDisposisi' onclick='RemoveTextBoxDisposisi(" + orderDisposisi + ")' class='btn btn-warning' style='display:block'> </div> </div>";
        $('#divDisposisi').append(html);

        orderDisposisi++;
    }
    function RemoveTextBoxPenerima(idDiv) {
        $("#divpenerimabaru" + idDiv).remove();
    }
    function RemoveTextBoxReceiver(idDiv) {
        $("#divReceiver" + idDiv).remove();
    }
    function RemoveTextBoxTembusan(idDiv) {
        $("#divtembusanbaru" + idDiv).remove();
    }
    function RemoveTextBoxDisposisi(idDiv) {
        $("#divDispo" + idDiv).remove();
    }
    function disposisi() {
        var divDisposisi = document.getElementById("disposisi");
        divDisposisi.style.display = "block";
    }
    function getListUserDispo(keyword) {
        $.ajax({
            url: "@Url.Action("GetUserCopy","Letter")",
            method: "POST",
            data: { keyword: keyword },
            success: function (msg) {
                var data = JSON.parse(msg);
                var html = "<datalist id='languageList'>";
                for (var i = 0; i < data.length; i++) {
                    html += "<option value='" + data[i].idUser + " - " + data[i].idPosition + "'>" + data[i].userName + " - " + data[i].positionName + "</option>"
                }
                html += "</datalist>";
                $("#dataListUserDispo").html("");
                $("#dataListUserDispo").html(html);

            }
        });
    }
    const letterStatus = @Model.letter.statusCode;
    if (letterStatus == 1 || letterStatus == 5) {
        tinymce.init({
            selector: 'textarea#isiSurat',
            height: 500,
            plugins: [
                'advlist', 'autolink', 'lists', 'link', 'image', 'charmap', 'preview',
                'anchor', 'searchreplace', 'visualblocks', 'code', 'fullscreen',
                'insertdatetime', 'media', 'table', 'help', 'wordcount'
            ],
            toolbar: 'undo redo | blocks | ' +
                'bold italic backcolor | alignleft aligncenter ' +
                'alignright alignjustify | bullist numlist outdent indent | ' +
                'removeformat | help',
            content_style: 'body { font-family:Helvetica,Arial,sans-serif; font-size:16px }'
        });
    } else {
        tinymce.init({
            selector: 'textarea#isiSurat',
            height: 500,
            readonly: true,
            plugins: [
                'advlist', 'autolink', 'lists', 'link', 'image', 'charmap', 'preview',
                'anchor', 'searchreplace', 'visualblocks', 'code', 'fullscreen',
                'insertdatetime', 'media', 'table', 'help', 'wordcount'
            ],
            toolbar: 'undo redo | blocks | ' +
                'bold italic backcolor | alignleft aligncenter ' +
                'alignright alignjustify | bullist numlist outdent indent | ' +
                'removeformat | help',
            content_style: 'body { font-family:Helvetica,Arial,sans-serif; font-size:16px }'
        });
    }
    tinymce.init({
        selector: 'textarea.data_template',
        height: 500,
        readonly: true,
        // menubar: false,
        plugins: [
            'advlist autolink lists link image charmap print preview anchor',
            'searchreplace visualblocks code fullscreen',
            'insertdatetime media table paste code help wordcount'
        ],
        toolbar: 'undo redo | formatselect | ' +
            'bold italic backcolor | alignleft aligncenter ' +
            'alignright alignjustify | bullist numlist outdent indent | help',
        // content_style: 'body { font-family:Helvetica,Arial,sans-serif; font-size:14px }'
    });

    function ganti_template(idTemplate, number) {
        if (confirm('Isi surat akan hilang apabila template dirubah, apakah ingin melanjutkan ?')) {
            var datatemplates = @Html.Raw(jsonTemplateData);
            var filter = "idContentTemplate";
            var filteredData = datatemplates.filter(function (obj) {
                return obj[filter] === idTemplate;
            });
            tinymce.get("isiSurat").setContent(filteredData[0].templateContent);
            $('#template_' + number).modal('hide');
            //console.log(filteredData);
        } else {
            return false;
        }
    }


    function AddTextBoxCheckerApprover() {
        var html = "<div id='divDispoApprover" + orderApprover + "' class='form-group row' style='margin-bottom: 0px;margin-top: 0px;'> <div class='col-8 col-md-6 col-sm-10'> <label>&nbsp;</label> <input type='text' class='form-control' id='checkerApprover_" + orderApprover + "' name='checkerApprover_" + orderApprover + "' placeholder='' autocomplete='off' required='' onkeyup='load_data_Approver(this.value," + orderApprover + ")'><span id='search_resultApprover_" + orderApprover + "'></span> <input type='hidden' class='form-control idUserApprover' id='idUserApprover_" + orderApprover + "' name='idUserApprover'> <input type='hidden' class='form-control idPositionApprover' id='idPositionApprover_" + orderApprover + "' name='idPositionApprover'><input type='hidden' class='form-control idPositionChecker' id='idLevelApprover_" + orderApprover + "' name='idLevelApprover'><input type='hidden' class='form-control' id='idUnitApprover_" + orderApprover + "' name='idUnitApprover'> </div>  <div class='col-4 col-md-6 col-sm-2'> <label>&nbsp;</label> <input type='button' value='-' id='btnRemoveChecker' onclick='RemoveTextBoxCheckerApprover(" + orderApprover + ")' class='btn btn-warning' style='display:block'> </div> </div>";
        $('#TextBoxContainerCheckerApprover').append(html);

        orderApprover++;
    }


    function RemoveTextBoxCheckerApprover(idDiv) {
        $("#divDispoApprover" + idDiv).remove();
    }


    function load_data_Approver(keyword, number) {
        if (keyword.length >= 3) {
            $.ajax({
                url: "@Url.Action("GetUserCopy","Letter")",
                method: "POST",
                data: { keyword: keyword },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    var html = '<div class="list-group">';
                    for (var i = 0; i < data.length; i++) {
                        var value = data[i].idUser + " - " + data[i].idPosition + " - " + data[i].idUnit;
                        var text = data[i].userName + " - " + data[i].positionName;
                        if (number == 1000) {
                            text = data[i].nip + " - " + data[i].positionName + " - " + data[i].userName;
                        }
                        html += '<div class="list-group-item list-group-item-action" onclick="get_text_Approver(\'' + text + '\',' + number + ',\'' + value + '\',' + data[i].idLevel + ')">' + text + '</div>';
                    }
                    html += '</div>';
                    if (number != 1000) {
                        document.getElementById('search_resultApprover_' + number).innerHTML = html;
                    }
                    else {
                        document.getElementById('search_result_sender').innerHTML = html;
                    }

                }
            });
        }
        else {
            if (number != 1000) {
                document.getElementById('search_resultApprover_' + number).innerHTML = '';
            } else {
                document.getElementById('search_result_sender').innerHTML = '';
            }
        }
    }


    function get_text_Approver(text, number, value, level) {
        console.log('value : ', text);
        var splitValue = value.split(" - ");
        var splitText = text.split(" - ");
        if (number != 1000) {
            document.getElementById('checkerApprover_' + number).value = text;
            document.getElementById('idUserApprover_' + number).value = splitValue[0];
            document.getElementById('idPositionApprover_' + number).value = splitValue[1];
            document.getElementById('idUnitApprover_' + number).value = splitValue[2];
            document.getElementById('idLevelApprover_' + number).value = level;
            document.getElementById('search_resultApprover_' + number).innerHTML = '';
        }


    }



</script>
<script>
    Dropzone.autoDiscover = false;
    var idresponse = 0;
    var files = 0;
    var idsrtfile = document.getElementById('idresponsesurat').value;
    var param = files + '~' + idsrtfile;

    var myDropzone = new Dropzone("div#dropss", {
        url: "@Url.Action("SaveAttachment","Letter")?param=" + param,
        // acceptedMimeTypes:'image/JPEG,image/jpeg,image/jpg,image/JPG,application/pdf,/application/PDF,application/doc,application/docx,application/xls,application/xlsx,application/DOC,application/DOCX,application/XLS,application/XLSX',
        autoProcessQueue: false,
        parallelUploads: 1, // Number of files process at a time (default 2)
        addRemoveLinks: true,
        maxFiles: 10,
        maxFilesize: 75,
        timeout: 30000,
        init: function () {
            this.on("addedfile", function () {
                // creates an array of the files that are in queue
                var arr = myDropzone.files.length;
                //alert(arr); // displays object and not the file name.
                document.getElementById("attachmentCount").value = arr;

            });
            this.on("removedfile", function () {
                // creates an array of the files that are in queue
                var arr = myDropzone.files.length;
                //alert(arr); // displays object and not the file name.
                document.getElementById("attachmentCount").value = arr;

            });
            this.on("success", function (file, response) {
                //alert(response);
                var res = JSON.parse(response);
                console.log(res);
                idresponse = res.idLetter;
                idsrtfile = res.idLetter;
                //alert('sukses');
                $(".dz-success-mark svg").css("background", "green");
                $(".dz-error-mark").css("display", "none");
                files += 1;
                param = files + '~' + idsrtfile;
                this.options.url = "@Url.Action("SaveAttachment","Letter")?param=" + param;
                myDropzone.processQueue();
            });
            this.on("complete", function (file) {
                //alert(response);
                if (this.getUploadingFiles().length === 0 && this.getQueuedFiles().length === 0) {
                    $('#idresponsesurat').val(idresponse);
                    //var tipes = document.getElementById('tipe').value
                    console.log(idresponse)
                    document.forms['formSurat'].submit();
                }

            });
            this.on("error", function (file, error, xhr) {
                alert(error);
                var ficheiro = { name: file.name, status: xhr.status, statusText: xhr.statusText, erro: error.message };
                console.log(ficheiro);
            });
        }

    });
</script>
<script>
    function saveSurat(flag) {
        document.getElementById("formSurat").action = "@Url.Action("SaveOutboxLetterBackdate","Letter")";
        var outboxType = document.getElementById("outboxType").value;
        var about = document.getElementById("about").value;
        var resultType = document.getElementById("resultType").value;
        var signatureType = document.getElementById("signatureType").value;
        var bossPositionId = document.getElementById("bossPositionId").value;
        var bossUserId = document.getElementById("bossUserId").value;
        var nipBoss = document.getElementById("nipBoss").value;
        var bossName = document.getElementById("bossName").value;
        var senderName = document.getElementById("senderName").value;
        var senderAddress = document.getElementById("senderAddress").value;
        var comment = document.getElementById("comment").value;
        if (outboxType == "") {
            callAlert("Jenis dokumen tidak boleh kosong!");
            return false;
        }
        if (about == "") {
            callAlert("Perihal surat tidak boleh kosong!");
            return false;
        }
        if (resultType == "") {
            callAlert("Hasil surat tidak boleh kosong!");
            return false;
        }
        if (signatureType == "") {
            callAlert("Tanda tangan surat tidak boleh kosong!");
            return false;
        }
        if (senderName == "" || senderAddress == "") {
            callAlert("Informasi penerima surat tidak boleh kosong!");
            return false;
        }
        if (bossPositionName == "" || bossPositionId == "" || bossUserId == "" || nipBoss == "" || bossName == "") {
            callAlert("Informasi pengirim surat tidak boleh kosong!");
            return false;
        }
        if (comment == "") {
            callAlert("Komentar surat tidak boleh kosong!");
            return false;
        }
        var message = "Anda yakin ingin mengirim surat ini?";
        if (flag == 1) {
            message = "Anda yakin ingin menyimpan surat ini?";
        }
        var conf = confirm(message);
        tinyMCE.triggerSave();
        if (conf == true) {
            $('#saveType').val(flag);
            if (myDropzone.files.length == 0) {
                document.forms['formSurat'].submit();
            }
            else {
                myDropzone.processQueue();
            }
            //document.forms['eval-form'].submit();a
        }
    }
    function aksiAtasan(flag) {
        var comment = document.getElementById("comment").value;
        if (comment == "") {
            callAlert("Komentar surat tidak boleh kosong!");
            return false;
        }
        var message = "Anda yakin ingin menyetujui surat ini?";
        if (flag == 5) {
            message = "Anda yakin ingin menolak surat ini?";
        }
        var conf = confirm(message);
        tinyMCE.triggerSave();
        if (conf == true) {
            $('#saveType').val(flag);
            document.forms['formSurat'].submit();
                    @*if (myDropzone.files.length == 0) {
                                document.forms['formSurat'].submit();
                                }
                                else {
                                myDropzone.processQueue();
                                }*@
                                                //document.forms['eval-form'].submit();
         }
    }
    //$('#formSurat').attr('action', '/Letter/SaveOutboxLetterBackdate');

    $('#btnPreview').click(function (e) {
        //e.preventDefault();
        var message = "Anda yakin ingin preview surat ini?";
        var conf = confirm(message);
        tinyMCE.triggerSave();
       @* $('#formSurat').attr('asp-action', 'SaveOutboxLetterBackdate');*@
        @*$('#formSurat').attr('action', '/EOFFICEBNILWEB/Letter/SavePrevOutboxLetter');*@
        @*$('#formSurat').attr('action', '/Letter/SaveOutboxLetterBackdate');*@
        $('#formSurat').attr('asp-action', 'SaveOutboxLetterBackdate');
        $('#formSurat').attr('action', '/EOFFICEBNILWEB/Letter/SaveOutboxLetterBackdate');
        if (conf == true) {
            const idLetter = document.getElementById('idresponsesurat').value;
            printSurat(idLetter);
            @*document.getElementById("btnPreview2").click = function () { window.open("Url.Action("PrintLetter","Letter")/" + data.Result) };*@
    @*$.blockUI({
                css: {
                border: 'none',
                padding: '15px',
                backgroundColor: '#000',
                '-webkit-border-radius': '10px',
                '-moz-border-radius': '10px',
                opacity: .5,
                color: '#fff'
                }
                });
                $('#saveType').val(3);
                var form = $(this).closest('form');
                form.ajaxSubmit({
                success: function (response, status, xhr, $form) {
                console.log(response);
                var data = JSON.parse(response);
                $.unblockUI();
                if (data.Status == "OK") {
                Swal.fire({
                position: 'center',
                icon: 'success',
                title: data.Message,
                text: data.Message,
                showConfirmButton: true,
                //timer: 1500,
                onBeforeOpen: () => {
                timerInterval = setInterval(() => {
                const content = Swal.getContent()
                if (content) {
                const b = content.querySelector('b')
                if (b) {
                b.textContent = Swal.getTimerLeft()
                }
                }
                }, 100)
                },
                onClose: () => {
                clearInterval(timerInterval)
                }
                }).then((result) => {
                /* Read more about handling dismissals below */
                })

                //alert(data.Result);
                //document.getElementById("btnPreview2").click = function () { window.open("Url.Action("PrintLetter","Letter")/" + data.Result) };
                printSurat(data.Result);
                setTimeout(function () {
                //your code to be executed after 1 second
                window.location = "@Url.Action("DraftMemo","Memo")";
                }, 3000);

                } else {
                callAlert(data.Message);
                }

                }
                });*@
        }
    });
    function printSurat(idLetter) {
       
        window.open("@Url.Action("PrintLetter","Letter")/" + idLetter);
    }

    function aksiNotif(idLetter) {
        if (confirm("Apakah anda yakin ingin mengirim notifikasi?")) {
            $.blockUI({
                css: {
                    border: 'none',
                    padding: '15px',
                    backgroundColor: '#000',
                    '-webkit-border-radius': '10px',
                    '-moz-border-radius': '10px',
                    opacity: .5,
                    color: '#fff'
                }
            });
            $.ajax({
                url: "@Url.Action("LetterNotifSecretary","Letter")",
                method: "POST",
                data: { idLetter: idLetter },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    $.unblockUI();
                    if (data.Status == "OK") {
                        Swal.fire({
                            position: 'center',
                            icon: 'success',
                            title: data.Message,
                            text: data.Message,
                            showConfirmButton: true,
                            //timer: 1500,
                            onBeforeOpen: () => {
                                timerInterval = setInterval(() => {
                                    const content = Swal.getContent()
                                    if (content) {
                                        const b = content.querySelector('b')
                                        if (b) {
                                            b.textContent = Swal.getTimerLeft()
                                        }
                                    }
                                }, 100)
                            },
                            onClose: () => {
                                clearInterval(timerInterval)
                            }
                        }).then((result) => {
                            /* Read more about handling dismissals below */
                        })

                        window.location.reload();
                    } else {
                        callAlert("Gagal Mengirim Notifikasi!");
                        window.location.reload();
                    }
                }
            });
        }
    }
    function deletefile(idFile) {
        if (confirm("Apakah anda yakin ingin menghapus lampiran ini?")) {
            $.ajax({
                url: "@Url.Action("DeleteAttachment","Letter")",
                method: "POST",
                data: { idFile: idFile },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    console.log(data);
                    window.location.reload();
                }
            });
        }
    }
    function callAlert(message) {
        Swal.fire({
            position: 'center',
            icon: 'error',
            title: 'Validasi',
            text: message,
            showConfirmButton: true,
            //timer: 1500,
            onBeforeOpen: () => {
                timerInterval = setInterval(() => {
                    const content = Swal.getContent()
                    if (content) {
                        const b = content.querySelector('b')
                        if (b) {
                            b.textContent = Swal.getTimerLeft()
                        }
                    }
                }, 100)
            },
            onClose: () => {
                clearInterval(timerInterval)
            }
        }).then((result) => {
            /* Read more about handling dismissals below */
        })
    }
    $('#submitDisposisi').click(function (e) {
        e.preventDefault();
        var btn = $(this);
        var form = $(this).closest('form');

        console.log(form);

        form.submit();
    });
</script>
<script>
    function get_text(text, number, value) {
        console.log('value : ', text);
        var splitValue = value.split(" - ");
        document.getElementById('idUserText_' + number).value = text;
        document.getElementById('idUser_' + number).value = splitValue[0];
        document.getElementById('idPosition_' + number).value = splitValue[1];
        document.getElementById('search_result_' + number).innerHTML = '';
    }

    function load_data(keyword, number) {
        if (keyword.length >= 3) {
            $.ajax({
                url: "@Url.Action("GetUserReceiver","Letter")",
                method: "POST",
                data: { keyword: keyword },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    var html = '<div class="list-group">';
                    for (var i = 0; i < data.length; i++) {
                        var value = data[i].idUser + " - " + data[i].idPosition;
                        var text = data[i].userName + " - " + data[i].positionName;
                        html += '<div class="list-group-item list-group-item-action" onclick="get_text(\'' + text + '\',' + number + ',\'' + value + '\')">' + text + '</div>';
                    }
                    html += '</div>';
                    document.getElementById('search_result_' + number).innerHTML = html;
                }
            });
        }
        else {
            document.getElementById('search_result_' + number).innerHTML = '';
        }
    }
    function load_data_pengirim(keyword, number) {
        if (keyword.length >= 3) {
            $.ajax({
                url: "@Url.Action("GetUserReceiver","Letter")",
                method: "POST",
                data: { keyword: keyword },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    var html = '<div class="list-group">';
                    for (var i = 0; i < data.length; i++) {
                        var value = data[i].idUser + " - " + data[i].idPosition + " - " + data[i].idUnit;
                        var text = data[i].userName + " - " + data[i].positionName;
                        if (number == 1000) {
                            text = data[i].nip + " - " + data[i].positionName + " - " + data[i].userName;
                        }
                        html += '<div class="list-group-item list-group-item-action" onclick="get_text_pemeriksa(\'' + text + '\',' + number + ',\'' + value + '\',' + data[i].idLevel + ')">' + text + '</div>';
                    }
                    html += '</div>';
                    if (number != 1000) {
                        document.getElementById('search_result_' + number).innerHTML = html;
                    } else {
                        document.getElementById('search_result_sender').innerHTML = html;
                    }

                }
            });
        }
        else {
            if (number != 1000) {
                document.getElementById('search_result_' + number).innerHTML = '';
            } else {
                document.getElementById('search_result_sender').innerHTML = '';
            }
        }
    }
    function load_data_pemeriksa(keyword, number) {
        if (keyword.length >= 3) {
            $.ajax({
                url: "@Url.Action("GetUserCopy","Letter")",
                method: "POST",
                data: { keyword: keyword },
                success: function (msg) {
                    var data = JSON.parse(msg);
                    var html = '<div class="list-group">';
                    for (var i = 0; i < data.length; i++) {
                        var value = data[i].idUser + " - " + data[i].idPosition + " - " + data[i].idUnit;
                        var text = data[i].userName + " - " + data[i].positionName;
                        if (number == 1000) {
                            text = data[i].nip + " - " + data[i].positionName + " - " + data[i].userName;
                        }
                        html += '<div class="list-group-item list-group-item-action" onclick="get_text_pemeriksa(\'' + text + '\',' + number + ',\'' + value + '\',' + data[i].idLevel + ')">' + text + '</div>';
                    }
                    html += '</div>';
                    if (number != 1000) {
                        document.getElementById('search_result_' + number).innerHTML = html;
                    } else {
                        document.getElementById('search_result_sender').innerHTML = html;
                    }

                }
            });
        }
        else {
            if (number != 1000) {
                document.getElementById('search_result_' + number).innerHTML = '';
            } else {
                document.getElementById('search_result_sender').innerHTML = '';
            }
        }
    }
    function get_text_pemeriksa(text, number, value, level) {
        console.log('value : ', text);
        var splitValue = value.split(" - ");
        var splitText = text.split(" - ");
        if (number != 1000) {
            document.getElementById('checker_' + number).value = text;
            document.getElementById('idUserChecker_' + number).value = splitValue[0];
            document.getElementById('idPositionChecker_' + number).value = splitValue[1];
            document.getElementById('idUnitChecker_' + number).value = splitValue[2];
            document.getElementById('idLevelChecker_' + number).value = level;
            document.getElementById('search_result_' + number).innerHTML = '';
        } else {
            document.getElementById('nipBoss').value = splitText[0];
            document.getElementById('bossPositionName').value = splitText[1];
            document.getElementById('bossName').value = splitText[2];
            document.getElementById('bossUserId').value = splitValue[0];
            document.getElementById('bossPositionId').value = splitValue[1];
            document.getElementById('bossUnitId').value = splitValue[2];
            document.getElementById('bossLevelId').value = level;
            document.getElementById('search_result_sender').innerHTML = '';
        }

    }
</script>